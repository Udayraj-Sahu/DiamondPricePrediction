"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[964],{50964:function(e,t,r){r.r(t),r.d(t,{ExperimentPage:function(){return Xi},default:function(){return Wi}});var n=r(4519),a=r(12187),i=r(40869);function s(){var e=n.useContext(a._y);return(0,i.lq)(e),e}var o=r(14585),l=r(37850),c=r(32048),d=r(50284),u=r(28928);const p=u.I0;var h=r(77537);const m=(0,n.createContext)(null),g=e=>{let{children:t,actions:r}=e;const[a,i]=(0,n.useState)([]),[s,o]=(0,n.useState)(!1),[u,g]=(0,n.useState)(null),v=p(),f=(0,n.useCallback)((e=>{g(null),(()=>{const t=e.map((e=>{const t=r.getExperimentApi(e);return v(t).catch((e=>{l.Z.logErrorAndNotifyUser(e)})),t.meta.id}));i((e=>(0,c.isEqual)(t,e)?e:t))})()}),[r,v]),y=(0,n.useMemo)((()=>({fetchExperiments:f,isLoadingExperiment:s,requestError:u,actions:r})),[r,f,s,u]);return(0,h.tZ)(m.Provider,{value:y,children:(0,h.tZ)(d.ZP,{shouldOptimisticallyRender:!0,requestIds:a,children:(e,r,n)=>(o(n.some((e=>a.includes(e.id)&&e.active))),u||n.forEach((e=>{e.error&&g(e.error)})),t)})})};var v=r(3060),f=r(67437),y=r(9394),C=r(26155);var x=r.p+"static/media/permission-denied-lock.16036747d57cd663d7df223781a447b2.svg",b=r(96803);function Z(e){let{errorMessage:t}=e;const{theme:r}=(0,b.u)();return(0,h.BX)("div",{className:"center",children:[(0,h.tZ)("img",{style:{height:300,marginTop:80},src:x,alt:"permission denied"}),(0,h.tZ)("h1",{style:{paddingTop:10},children:"Permission Denied"}),(0,h.tZ)("h2",{"data-testid":"error-message",css:(0,C.iv)({color:r.colors.textSecondary},""),children:t||"The current user does not have permission to view this page."})]})}var E=r(91994);const R=e=>{let{artifactLocation:t}=e;return(0,h.tZ)(h.HY,{children:t})},S=n.memo((e=>{let{experiment:t}=e;return(0,h.BX)("div",{css:k.container,children:[(0,h.BX)(b.T.Text,{color:"secondary",children:[(0,h.tZ)(E.Z,{id:"PZGZHV",defaultMessage:"Experiment ID"}),": ",t.experiment_id]}),(0,h.BX)(b.T.Text,{color:"secondary",children:[(0,h.tZ)(E.Z,{id:"8/7V3S",defaultMessage:"Artifact Location"}),": ",(0,h.tZ)(R,{artifactLocation:t.artifact_location})]})]})})),k={container:e=>({display:"flex",gap:e.spacing.lg})};var w=r(83934),M=r(2664),B=r(29709),T=r(24374);const I=()=>{const e=(0,n.useContext)(m);if(!e)throw new Error("Trying to use GetExperimentsContext actions outside of the context!");return e},L=n.memo((e=>{let{experiment:t}=e;const r=(0,u.v9)((e=>{const r=(0,B.aq)(t.experiment_id,e);return r?(e=>{var t;return(null===(t=Object.values(e).find((e=>e.getKey()===T._)))||void 0===t?void 0:t.value)||void 0})(r):""})),[a,i]=(0,n.useState)(!1),{actions:{setExperimentTagApi:s}}=I(),o=p(),l=(0,n.useCallback)((e=>{const r=s(t.experiment_id,T._,e);o(r).then((()=>i(!1)))}),[t.experiment_id,s,o]);return(0,h.tZ)(w.a,{title:(0,h.BX)("span",{css:A.collapsibleSectionHeader,children:[(0,h.tZ)(E.Z,{id:"wDwAdX",defaultMessage:"Description"})," ",!a&&(0,h.tZ)(b.B,{type:"link",onClick:()=>i(!0),children:(0,h.tZ)(E.Z,{id:"2YEXRM",defaultMessage:"Edit"})})]}),forceOpen:a,defaultCollapsed:!r,"data-test-id":"experiment-notes-section",children:(0,h.tZ)(M.U,{defaultMarkdown:r,onSubmit:l,onCancel:()=>i(!1),showEditor:a})})})),A={collapsibleSectionHeader:{height:"32px",lineHeight:"32px"}};var D=r(98750);const N=e=>{let{experiment:t}=e;const r=s();return(0,h.tZ)(b.T.Text,{size:"xl",dangerouslySetAntdProps:{copyable:{text:t.name,icon:(0,h.tZ)(v.TIy,{}),tooltips:[r.formatMessage({id:"A7R0ii",defaultMessage:"Copy path"}),r.formatMessage({id:"JCboZ7",defaultMessage:"Path copied"})]}}})},O=e=>{let{copyText:t}=e;const[r,a]=(0,n.useState)(!1);return(0,h.tZ)(b.e,{title:(0,h.tZ)(E.Z,{id:"X+boXI",defaultMessage:"Copied"}),dangerouslySetAntdProps:{visible:r},children:(0,h.tZ)(b.B,{type:"primary",onClick:()=>{navigator.clipboard.writeText(t),a(!0),setTimeout((()=>{a(!1)}),3e3)},onMouseLeave:()=>{a(!1)},children:(0,h.tZ)(E.Z,{id:"1Iq+NW",defaultMessage:"Copy"})})})};var P={name:"490tlg",styles:"display:flex;gap:4px"};const U=e=>{let{copyText:t}=e;return(0,h.BX)("div",{css:P,children:[(0,h.tZ)(b.h,{readOnly:!0,value:t,"data-test-id":"copy-box"}),(0,h.tZ)(O,{copyText:t})]})},H=e=>{let{visible:t,onCancel:r,link:n}=e;return(0,h.tZ)(v.u_l,{title:(0,h.tZ)(E.Z,{id:"ktiuki",defaultMessage:"Get Link"}),visible:t,onCancel:r,children:(0,h.tZ)(U,{copyText:n})})},F=()=>{var e;const[t,r]=(0,n.useState)(!1);return(0,h.BX)(h.HY,{children:[(0,h.tZ)(H,{link:(null===(e=window.top)||void 0===e?void 0:e.location.href)||window.location.href,visible:t,onCancel:()=>r(!1)}),(0,h.tZ)(b.B,{type:"primary",onClick:()=>r(!0),"data-test-id":"share-button",children:(0,h.tZ)(E.Z,{id:"2oFAO4",defaultMessage:"Share"})})]})};var _=r(8217),K=r(53185);var X={name:"ny5p0o",styles:"margin-left:16px"};const W=n.memo((e=>{let{experiment:t}=e;const r=(0,n.useMemo)((()=>t.name.split("/").pop()),[t.name]),a=(0,K.E)();return(0,h.tZ)(D.mr,{title:(0,h.BX)("div",{css:$.headerWrapper,children:[r," ",(0,h.tZ)(N,{experiment:t})," ",Boolean((0,_.c)()&&a)&&(0,h.tZ)("a",{href:a,target:"_blank",rel:"noreferrer",children:(0,h.tZ)(b.B,{css:X,type:"link",size:"small",children:(0,h.tZ)(E.Z,{id:"d78wwA",defaultMessage:"Provide Feedback"})})})]}),breadcrumbs:[],children:(0,h.tZ)(F,{})})})),$={sendFeedbackPopoverContent:{display:"flex",maxWidth:250,flexDirection:"column",alignItems:"flex-end"},headerWrapper:e=>({display:"inline-flex",gap:e.spacing.sm,alignItems:"center"})},z=n.memo((e=>{let{experiments:t}=e;const r=(0,n.useMemo)((()=>(0,h.tZ)(E.Z,{id:"Dhn7Mb",defaultMessage:"Displaying Runs from {numExperiments} Experiments",values:{numExperiments:t.length}})),[t.length]);return(0,h.tZ)(D.mr,{title:r,breadcrumbs:[],children:(0,h.tZ)(F,{})})}));let V,j;!function(e){e.ACTIVE="Active",e.DELETED="Deleted"}(V||(V={})),function(e){e.WITH_MODEL_VERSIONS="With Model Versions",e.WTIHOUT_MODEL_VERSIONS="Without Model Versions",e.ALL_RUNS="All Runs"}(j||(j={}));var Y=r(2010);const q=(e,t)=>{const{experiments:r}=t,n=r.map((e=>e.experiment_id)),a=n.length>1,i=Object.values(e.entities.runInfosByUuid).filter((e=>{let{experiment_id:t}=e;return n.includes(t)})).map((e=>{let{run_uuid:t}=e;return t})),{modelVersionsByRunUuid:s,runUuidsMatchingFilter:o}=e.entities,l=((e,t,r)=>{let{lifecycleFilter:n=V.ACTIVE,modelVersionFilter:a=j.ALL_RUNS}=r;const{modelVersionsByRunUuid:i}=t.entities;return e.map((e=>(0,B.hQ)(e,t))).filter((e=>n===V.ACTIVE?"active"===e.lifecycle_stage:"deleted"===e.lifecycle_stage)).filter((e=>a===j.ALL_RUNS||(a===j.WITH_MODEL_VERSIONS?e.run_uuid in i:a===j.WTIHOUT_MODEL_VERSIONS?!(e.run_uuid in i):(console.warn("Invalid input to model version filter - defaulting to showing all runs."),!0))))})(i,e,t),c=new Set,d=new Set,u=l.map((t=>{const r=(0,Y.nQ)(t.run_uuid,e),n=Object.values(r||{});return n.forEach((e=>{c.add(e.key)})),n})),p=l.map((t=>{const r=Object.values((0,B.Qf)(t.run_uuid,e));return r.forEach((e=>{d.add(e.key)})),r})),h=l.map((t=>(0,B.Ml)(t.run_uuid,e))),m=n[0];return{modelVersionsByRunUuid:s,experimentTags:a?{}:(0,B.aq)(m,e),runInfos:l,paramsList:p,tagsList:h,metricsList:u,runUuidsMatchingFilter:o,metricKeyList:Array.from(c.values()).sort(),paramKeyList:Array.from(d.values()).sort()}};var G=r(46285);class Q extends n.Component{handleSortBy(){const{canonicalSortKey:e,orderByAsc:t,orderByKey:r}=this.props;let n=!t;e!==r&&(n=!1),this.props.onSortBy(e,n)}render(){const{enableSorting:e,canonicalSortKey:t,displayName:r,getClassName:n=(()=>""),orderByKey:a,orderByAsc:i}=this.props;return(0,h.BX)("div",{role:"columnheader",css:J.headerLabelWrapper(e),className:n(t),onClick:e?()=>this.handleSortBy():void 0,children:[(0,h.tZ)("span",{"data-test-id":`sort-header-${r}`,children:r}),e&&t===a?i?(0,h.tZ)(b.y,{}):(0,h.tZ)(b.z,{}):null]})}}const J={headerLabelWrapper:e=>t=>({height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 12px",svg:{color:t.colors.textSecondary},"&:hover":{color:e?t.colors.actionTertiaryTextHover:"unset",svg:{color:t.colors.actionTertiaryTextHover}}}),headerSortIcon:{marginRight:4}},ee=()=>(0,h.tZ)(v.oOx,{css:e=>({color:e.colors.textValidationDanger})}),te=()=>(0,h.tZ)(v.rE2,{css:e=>({color:e.colors.textValidationSuccess})}),re=e=>{switch(e){case"FAILED":case"KILLED":return(0,h.tZ)(ee,{});case"FINISHED":return(0,h.tZ)(te,{});case"SCHEDULED":return(0,h.tZ)(v.T39,{});default:return null}},ne=n.memo((e=>{let{value:{startTime:t,referenceTime:r,runStatus:n}}=e;return(0,h.BX)("span",{css:ae.cellWrapper,title:l.Z.formatTimestamp(t),children:[re(n),l.Z.timeSinceStr(t,r)]})})),ae={cellWrapper:e=>({display:"flex",alignItems:"center",gap:e.spacing.sm,svg:{width:14,height:14}})};var ie=r(17032),se=r(86509);const oe=n.memo((e=>{let{data:t,value:r}=e;return(0,h.tZ)(ie.rU,{to:se.Z.getExperimentPageRoute(t.experimentId),title:r.name,children:r.basename})})),le=e=>{let{text:t,maxSize:r,className:a,allowShowMore:i=!1}=e;if(t.length<=r)return(0,h.tZ)("span",{className:a,children:t});const s=`${t.substr(0,r)}...`,[o,l]=(0,n.useState)(!1);return(0,h.BX)("span",{className:a,children:[o?t:s,i&&(0,h.tZ)(b.B,{type:"link",onClick:()=>l(!o),size:"small",css:ce.expandButton,"data-test-id":"trimmed-text-button",children:o?"collapse":"expand"})]})},ce={expandButton:{display:"inline-block"}};var de=r.p+"static/media/logged-model.dd9b21ff4fb07f3cadeada8046a2693b.svg";var ue=r.p+"static/media/registered-model.24429a4f6158e57b01b3928e2605aa25.svg",pe=r(2166);const he=n.memo((e=>{const{registeredModels:t,loggedModels:r,experimentId:n,runUuid:a}=e.value,i=l.Z.mergeLoggedAndRegisteredModels(r,t);if(i&&i.length){const e=i[0];let t;if(e.registeredModelName){const{registeredModelName:r,registeredModelVersion:n}=e;t=(0,h.BX)(h.HY,{children:[(0,h.tZ)("img",{"data-test-id":"registered-model-icon",alt:"",title:"Registered Model",src:ue}),(0,h.BX)("a",{href:l.Z.getIframeCorrectedRoute((0,pe.u5)(r,n)),className:"registered-model-link",target:"_blank",rel:"noreferrer",children:[(0,h.tZ)(le,{text:r,maxSize:10,className:"model-name"}),`/${n}`]})]})}else if(e.flavors){const r=e.flavors?e.flavors[0]:"Model",i=l.Z.getIframeCorrectedRoute(`${se.Z.getRunPageRoute(n,a)}/artifactPath/${e.artifactPath}`);t=(0,h.BX)(h.HY,{children:[(0,h.tZ)("img",{"data-test-id":"logged-model-icon",alt:"",title:"Logged Model",src:de}),(0,h.tZ)("a",{href:i,target:"_blank",className:"logged-model-link",children:r})]})}return(0,h.BX)("div",{className:"logged-model-cell",css:me.imageWrapper,children:[t,r.length>1?`, ${r.length-1} more`:""]})}return(0,h.tZ)(h.HY,{children:"-"})})),me={imageWrapper:{img:{height:"15px",position:"relative",marginRight:"4px"}}},ge=n.memo((e=>{let{value:t}=e;const r=l.Z.renderSource(t,void 0,void 0);return r?(0,h.BX)(h.HY,{children:[l.Z.renderSourceTypeIcon(t),r]}):(0,h.tZ)(h.HY,{children:"-"})})),ve=n.memo((e=>{let{value:{version:t,name:r,type:n}}=e;return l.Z.renderSourceVersion(t,r,n)||(0,h.tZ)(h.HY,{children:"-"})}));var fe=r(62632);const{formatTimestamp:ye,getDuration:Ce,getRunNameFromTags:xe,getSourceType:be,getSourceName:Ze,getUser:Ee}=l.Z,Re=e=>e.reduce(((e,t)=>({...e,[t.key]:t})),{}),Se=e=>void 0===e?"":/[,"\r\n]/.test(e)?'"'+e.replace(/"/g,'""')+'"':e,ke=e=>{const{runInfos:t,paramKeyList:r,metricKeyList:n,tagKeyList:a,paramsList:i,metricsList:s,tagsList:o}=e;return((e,t)=>{let r,n="";for(r=0;r<e.length;r++)n+=Se(e[r]),r<e.length-1&&(n+=",");for(n+="\n",r=0;r<t.length;r++){for(let e=0;e<t[r].length;e++)n+=Se(t[r][e]),e<t[r].length-1&&(n+=",");n+="\n"}return n})(["Start Time","Duration","Run ID","Name","Source Type","Source Name","User","Status",...r,...n,...a],t.map(((e,t)=>{const l=[ye(e.start_time),Ce(e.start_time,e.end_time)||"",e.run_uuid,e.run_name||xe(o[t]),be(o[t]),Ze(o[t]),Ee(e,o[t]),e.status],c=Re(i[t]),d=Re(s[t]),u=o[t];return r.forEach((e=>{c[e]?l.push(c[e].value):l.push("")})),n.forEach((e=>{d[e]?l.push(d[e].value):l.push("")})),a.forEach((e=>{u[e]?l.push(u[e].value):l.push("")})),l})))},we="$$$param$$$",Me="$$$metric$$$",Be="$$$tag$$$";let Te;!function(e){e.SHOWALL="SHOWALL",e.HIDEALL="HIDEALL"}(Te||(Te={}));const Ie=(e,t)=>{let r="";return(t.includes('"')||t.includes(" ")||t.includes("."))&&(r="`"),t.includes("`")&&(r='"'),`${e}.${r}${t}${r}`},Le={mouseEnterDelay:0,mouseLeaveDelay:0},Ae=n.memo((e=>{const{pinned:t,hidden:r}=e.value;return(0,h.BX)("div",{css:De.actionsContainer,children:[(0,_.c)()&&(0,h.tZ)(b.e,{dangerouslySetAntdProps:Le,placement:"right",title:r?(0,h.tZ)(E.Z,{id:"xmpvlI",defaultMessage:"Unhide run"}):(0,h.tZ)(E.Z,{id:"qTjYVU",defaultMessage:"Hide run"}),children:(0,h.BX)("label",{css:De.actionCheckbox,className:"is-visibility-toggle",children:[(0,h.tZ)("input",{type:"checkbox",checked:!r,onChange:()=>{e.onToggleVisibility(e.data.runUuid)}}),r?(0,h.tZ)(v.wJG,{}):(0,h.tZ)(v.bMb,{})]})}),e.data.pinnable&&(0,h.tZ)(b.e,{dangerouslySetAntdProps:Le,placement:"right",title:t?(0,h.tZ)(E.Z,{id:"ugm2f6",defaultMessage:"Unpin run"}):(0,h.tZ)(E.Z,{id:"fjiojF",defaultMessage:"Pin run"}),children:(0,h.BX)("label",{css:De.actionCheckbox,className:"is-pin-toggle","data-testid":"column-pin-toggle",children:[(0,h.tZ)("input",{type:"checkbox",checked:t,onChange:()=>{e.onTogglePin(e.data.runUuid)}}),t?(0,h.tZ)(v.D$V,{}):(0,h.tZ)(v.qQX,{})]})})]})}),((e,t)=>e.value.hidden===t.value.hidden&&e.value.pinned===t.value.pinned)),De={actionsContainer:()=>({display:"flex",gap:18}),actionCheckbox:e=>({input:{width:0,appearance:"none"},cursor:"pointer",display:"flex",svg:{width:14,height:14,cursor:"pointer"},"&.is-pin-toggle svg":{color:"transparent",".ag-row:hover &":{color:e.colors.grey600}},"&.is-visibility-toggle svg":{color:e.colors.grey400,".ag-row:hover &":{color:e.colors.grey600}},"& input:checked + span svg":{color:e.colors.grey600}})},Ne=n.memo((e=>(0,h.BX)(v.h_2.Root,{modal:!1,children:[(0,h.tZ)(v.h_2.Trigger,{asChild:!0,children:(0,h.tZ)("button",{css:Oe.actionButton,"data-testid":"experiment-view-runs-visibility-column-header",children:(0,h.tZ)(v.bMb,{})})}),(0,h.BX)(v.h_2.Content,{children:[(0,h.BX)(v.h_2.Item,{onClick:()=>e.onToggleVisibility(Te.HIDEALL),"data-testid":"experiment-view-runs-visibility-hide-all",children:[(0,h.tZ)(v.h_2.IconWrapper,{children:(0,h.tZ)(v.wJG,{})}),(0,h.tZ)(E.Z,{id:"UEESlL",defaultMessage:"Hide all runs"})]}),(0,h.BX)(v.h_2.Item,{onClick:()=>e.onToggleVisibility(Te.SHOWALL),"data-testid":"experiment-view-runs-visibility-show-all",children:[(0,h.tZ)(v.h_2.IconWrapper,{children:(0,h.tZ)(v.bMb,{})}),(0,h.tZ)(E.Z,{id:"4yjF8O",defaultMessage:"Show all runs"})]})]})]}))),Oe={actionButton:e=>({background:"transparent",border:"none",cursor:"pointer",padding:"8px",".ag-checkbox:not(.ag-hidden) + &":{padding:"0 1px"},svg:{width:14,height:14,cursor:"pointer",color:e.colors.grey600}})},Pe=n.memo((e=>{let{onExpand:t,data:{runName:r,experimentId:n,runUuid:a,runDateAndNestInfo:i,color:s}}=e;const{hasExpander:o,expanderOpen:l,childrenIds:c,level:d}=i||{},u=!isNaN(d)&&o,p=(0,_.c)();return(0,h.BX)("div",{css:Ue.cellWrapper,children:[(0,h.tZ)("div",{css:Ue.expanderWrapper,children:(0,h.tZ)("div",{css:Ue.nestLevel(d),children:u&&(0,h.tZ)(b.B,{css:Ue.expanderButton,size:"small",onClick:()=>{t(a,c)},type:"link",icon:l?(0,h.tZ)(v.uSo,{}):(0,h.tZ)(v.IAe,{})},"Expander-"+a)})}),(0,h.BX)(ie.rU,{to:se.Z.getRunPageRoute(n,a),css:Ue.runLink,children:[p&&(0,h.tZ)("div",{css:Ue.colorPill,"data-testid":"experiment-view-table-run-color",style:{backgroundColor:s}}),(0,h.tZ)("span",{css:Ue.runName,children:r})]})]})})),Ue={link:e=>({display:"inline-block",minWidth:e.typography.fontSizeBase,minHeight:e.typography.fontSizeBase}),cellWrapper:{display:"flex"},expanderButton:{svg:{width:12,height:12}},runLink:{overflow:"hidden",display:"flex",gap:8,alignItems:"center"},runName:{overflow:"hidden",textOverflow:"ellipsis"},expanderWrapper:{display:"none",".ag-grid-expanders-visible &":{display:"block"}},colorPill:{width:12,height:12,borderRadius:6,flexShrink:0,"@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)":{marginBottom:1}},nestLevel:e=>t=>({display:"flex",justifyContent:"flex-end",width:(e+1)*t.spacing.lg,height:t.spacing.lg})};var He={name:"gikiyg",styles:"display:flex;justify-content:center;align-items:center;height:32px"};const Fe=n.memo((e=>{let{loadMoreRunsFunc:t}=e;return(0,h.tZ)("div",{css:He,children:(0,h.tZ)(b.B,{type:"primary",onClick:t,size:"small",children:(0,h.tZ)(E.Z,{id:"9CqEWy",defaultMessage:"Load more"})})})})),_e=e=>(0,_.c)()?e?70:104:70,Ke=(e,t)=>e+".`"+t+"`",Xe=(e,t)=>e.startsWith(t),We=(e,t)=>e.substring(t.length+2).slice(0,-1),$e=e=>`$$$param$$$-${e}`,ze=e=>`$$$metric$$$-${e}`,Ve=e=>`$$$tag$$$-${e}`,je={[G.XZ.USER]:Ke(G.D5.ATTRIBUTES,"User"),[G.XZ.RUN_NAME]:Ke(G.D5.ATTRIBUTES,"Run Name"),[G.XZ.SOURCE]:Ke(G.D5.ATTRIBUTES,"Source"),[G.XZ.VERSION]:Ke(G.D5.ATTRIBUTES,"Version")},Ye=e=>{let{data:t}=e;return t.runUuid},qe=e=>{let{rowNode:t}=e;return t.data.isLoadMoreRow},Ge=[G.z.USER,G.z.SOURCE,G.z.VERSION,G.z.MODELS],Qe=[G.z.EXPERIMENT_NAME,...Ge],Je=e=>{let{searchFacetsState:t,onSortBy:r,compareExperiments:a,onTogglePin:i,onToggleVisibility:s,onExpand:o,paramKeyList:d,metricKeyList:u,tagKeyList:p,columnApi:h,isComparingRuns:m}=e;const{orderByAsc:g,orderByKey:v,selectedColumns:f}=t,y=(e=>{let{paramKeyList:t,metricKeyList:r,tagKeyList:a}=e;const i=(0,n.useRef)(new Set),s=(0,n.useRef)(new Set),o=(0,n.useRef)(new Set),l=(0,n.useMemo)((()=>(t.forEach((e=>s.current.add(e))),Array.from(s.current))),[t]),c=(0,n.useMemo)((()=>(r.forEach((e=>i.current.add(e))),Array.from(i.current))),[r]),d=(0,n.useMemo)((()=>(a.forEach((e=>o.current.add(e))),Array.from(o.current))),[a]);return(0,n.useMemo)((()=>({paramKeys:l,metricKeys:c,tagKeys:d})),[c,l,d])})({metricKeyList:u,tagKeyList:p,paramKeyList:d}),C=(0,n.useMemo)((()=>{const e={orderByKey:v,orderByAsc:g,onSortBy:r},t=e=>e===v?"is-ordered-by":void 0,n=e=>t(e),d=e=>{let{colDef:r}=e;return t(r.headerComponentParams.canonicalSortKey)},u=[];if(u.push({valueGetter:e=>{let{data:{pinned:t,hidden:r}}=e;return{pinned:t,hidden:r}},checkboxSelection:!m,headerComponent:(0,_.c)()?"RowActionsHeaderCellRenderer":void 0,headerComponentParams:{onToggleVisibility:s},headerCheckboxSelection:!m,headerName:"",cellClass:"is-checkbox-cell",cellRenderer:"RowActionsCellRenderer",cellRendererParams:{onTogglePin:i,onToggleVisibility:s},pinned:"left",minWidth:_e(m),width:_e(m),maxWidth:_e(m),resizable:!1}),u.push({headerName:G.z.RUN_NAME,colId:je[G.XZ.RUN_NAME],headerTooltip:G.XZ.RUN_NAME,pinned:"left",sortable:!0,field:"runDateAndNestInfo",cellRenderer:"RunNameCellRenderer",cellRendererParams:{onExpand:o},equals:(e,t)=>(0,c.isEqual)(e,t),headerComponentParams:{...e,canonicalSortKey:G.XZ.RUN_NAME,getClassName:n},cellClass:d,initialWidth:(0,_.c)()?310:260,resizable:!m}),m)return u;u.push({headerName:G.z.DATE,headerTooltip:G.XZ.DATE,pinned:"left",sortable:!0,field:"runDateAndNestInfo",cellRenderer:"DateCellRenderer",cellRendererParams:{onExpand:o},equals:(e,t)=>(0,c.isEqual)(e,t),headerComponentParams:{...e,canonicalSortKey:G.XZ.DATE,getClassName:n},cellClass:d,initialWidth:150}),u.push({headerName:G.z.DURATION,field:"duration",initialWidth:80,cellClass:d}),a&&u.push({headerName:G.z.EXPERIMENT_NAME,colId:Ke(G.D5.ATTRIBUTES,G.z.EXPERIMENT_NAME),field:"experimentName",cellRenderer:"ExperimentNameCellRenderer",equals:(e,t)=>(0,c.isEqual)(e,t),initialWidth:140,cellClass:d,initialHide:!0}),u.push({headerName:G.z.USER,colId:je[G.XZ.USER],headerTooltip:G.XZ.USER,field:"user",sortable:!0,headerComponentParams:{...e,canonicalSortKey:G.XZ.USER,getClassName:n},cellClass:d,initialHide:!0}),u.push({headerName:G.z.SOURCE,colId:je[G.XZ.SOURCE],field:"tags",cellRenderer:"SourceCellRenderer",equals:(e,t)=>l.Z.getSourceName(e)===l.Z.getSourceName(t),sortable:!0,headerComponentParams:{...e,canonicalSortKey:G.XZ.SOURCE,getClassName:n},cellClass:d,initialHide:!0}),u.push({headerName:G.z.VERSION,colId:je[G.XZ.VERSION],field:"version",cellRenderer:"VersionCellRenderer",equals:(e,t)=>(0,c.isEqual)(e,t),sortable:!0,headerComponentParams:{...e,canonicalSortKey:G.XZ.VERSION,getClassName:n},cellClass:d,initialHide:!0}),u.push({headerName:G.z.MODELS,colId:Ke(G.D5.ATTRIBUTES,G.z.MODELS),field:"models",cellRenderer:"ModelsCellRenderer",initialWidth:200,equals:(e,t)=>(0,c.isEqual)(e,t),initialHide:!0});const{metricKeys:p,paramKeys:h,tagKeys:f}=y;return p.length&&u.push({headerName:"Metrics",colId:G.D5.METRICS,children:p.map((t=>{const r=Ke(G.D5.METRICS,t);return{headerName:t,colId:r,headerTooltip:Ie(G.D5.METRICS,t),field:ze(t),tooltipField:ze(t),initialWidth:100,initialHide:!0,sortable:!0,headerComponentParams:{...e,canonicalSortKey:r,getClassName:n},cellClass:d}}))}),h.length&&u.push({headerName:"Parameters",colId:G.D5.PARAMS,children:h.map((t=>{const r=Ke(G.D5.PARAMS,t);return{colId:r,headerName:t,headerTooltip:Ie(G.D5.PARAMS,t),field:$e(t),tooltipField:$e(t),initialHide:!0,initialWidth:100,sortable:!0,headerComponentParams:{...e,canonicalSortKey:r,getClassName:n},cellClass:d}}))}),f.length&&u.push({headerName:"Tags",colId:G.D5.TAGS,children:f.map((e=>({colId:Ke(G.D5.TAGS,e),headerName:e,initialHide:!0,initialWidth:100,headerTooltip:Ie(G.D5.TAGS,e),field:Ve(e),tooltipField:Ve(e)})))}),u}),[v,g,r,i,s,o,a,y,m]),x=(0,n.useMemo)((()=>[...Qe.map((e=>Ke(G.D5.ATTRIBUTES,e))),...y.paramKeys.map((e=>Ke(G.D5.PARAMS,e))),...y.metricKeys.map((e=>Ke(G.D5.METRICS,e))),...y.tagKeys.map((e=>Ke(G.D5.TAGS,e)))]),[y]);return(0,n.useEffect)((()=>{if(h&&!m)for(const e of x){const t=f.includes(e);h.setColumnVisible(e,t)}}),[f,h,x,m]),C},et={initialWidth:100,autoSizePadding:0,headerComponentParams:{menuIcon:"fa-bars"},resizable:!0,filter:!0,suppressMenu:!0,suppressMovable:!0};var tt=r(76082),rt=r(13e3);class nt extends n.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.deleteRunApi(t))})),Promise.all(e).catch((()=>{this.props.openErrorModal("While deleting an experiment run, an error occurred.")}))}render(){const e=this.props.selectedRunIds.length;return(0,h.tZ)(rt.s,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Delete Experiment ${l.Z.pluralize("Run",e)}`,helpText:(0,h.BX)("div",{children:[(0,h.tZ)("p",{children:(0,h.BX)("b",{children:[e," experiment ",l.Z.pluralize("run",e)," will be deleted."]})}),""]}),confirmButtonText:"Delete"})}}const at={deleteRunApi:o.Gd,openErrorModal:o.yQ};var it=(0,u.$j)(null,at)(nt),st=r(11616);class ot extends n.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.restoreRunApi(t))})),Promise.all(e).catch((e=>{this.props.openErrorModal("While restoring an experiment run, an error occurred.")}))}render(){const e=this.props.selectedRunIds.length;return(0,h.tZ)(rt.s,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Restore Experiment ${l.Z.pluralize("Run",e)}`,helpText:`${e} experiment ${l.Z.pluralize("run",e)} will be restored.`,confirmButtonText:"Restore"})}}const lt={restoreRunApi:o.Y1,openErrorModal:o.yQ};var ct=(0,u.$j)(null,lt)(ot),dt=r(22637),ut=r.n(dt);const pt=()=>{var e;const t=(0,tt.$B)(),r=(0,tt.TH)(),a=(0,n.useMemo)((()=>decodeURIComponent(r.search)),[r.search]),i=(0,n.useMemo)((()=>{const e=ut().parse(a.substring(1));if(e.experiments){const t=e.experiments;return(null===t||void 0===t?void 0:t.toString())||""}return""}),[a]);return(0,n.useMemo)((()=>{var e,r;if(null!==(e=t.params)&&void 0!==e&&e.experimentId)return[null===(r=t.params)||void 0===r?void 0:r.experimentId];if(i)try{return JSON.parse(i)}catch{return l.Z.logErrorAndNotifyUser(`Could not parse experiment query parameter ${i}`),""}return[]}),[i,null===(e=t.params)||void 0===e?void 0:e.experimentId])};var ht=r(29009),mt=r(25272);const gt={ALL:null,LAST_HOUR:36e5,LAST_24_HOURS:864e5,LAST_7_DAYS:6048e5,LAST_30_DAYS:2592e6,LAST_YEAR:31104e6},vt=(e,t)=>!(0,c.isEqual)(e.searchFilter,t.searchFilter)||!(0,c.isEqual)(e.orderByAsc,t.orderByAsc)||!(0,c.isEqual)(e.orderByKey,t.orderByKey)||!(0,c.isEqual)(e.lifecycleFilter,t.lifecycleFilter)||!(0,c.isEqual)(e.startTime,t.startTime),ft=(e,t,r,n)=>{const a=t.lifecycleFilter===V.ACTIVE?mt.bW.ACTIVE_ONLY:mt.bW.DELETED_ONLY,{runsPinned:i}=t,s=(e=>{let{orderByKey:t,orderByAsc:r}=e;return t?r?[t+" ASC"]:[t+" DESC"]:[]})(t),o=((e,t)=>{let{startTime:r}=e;const n=gt[r];return r&&n&&"ALL"!==r?"attributes.start_time >= "+(t-n):null})(t,r),l=((e,t)=>{let{searchFilter:r}=e;return r&&t?`${r} and ${t}`:!r&&t?t:r||void 0})(t,o),c=(e=>{let{orderByKey:t,searchFilter:r}=e;return!t&&!r||t===G.XZ.DATE})(t);return{experimentIds:e,filter:l,runViewType:a,orderBy:s,shouldFetchParents:c,pageToken:n,runsPinned:i}},yt=(e,t,r)=>{const n=e.filter((e=>e.data.tags.some((e=>"mlflow.log-model.history"===e.key))));(0,c.chunk)(n,ht.mc).forEach((e=>{const n=t({run_id:e.map((e=>e.info.run_id))});r(n)}))};var Ct=r(983);const xt=[Ke(G.D5.ATTRIBUTES,G.z.SOURCE),Ke(G.D5.ATTRIBUTES,G.z.MODELS)],bt=e=>{const{lifecycleFilter:t,modelVersionFilter:r,searchFilter:n,startTime:a,orderByAsc:i,orderByKey:s}=new Et;return{...e,lifecycleFilter:t,modelVersionFilter:r,searchFilter:n,startTime:a,orderByAsc:i,orderByKey:s}},Zt=e=>{const{lifecycleFilter:t,modelVersionFilter:r,searchFilter:n,startTime:a}=e;return Boolean(t!==G.FJ||r!==G.oj||n||a!==G.wi)};class Et{constructor(){this.searchFilter="",this.orderByKey=G.gB,this.orderByAsc=G.yG,this.startTime=G.wi,this.lifecycleFilter=G.FJ,this.modelVersionFilter=G.oj,this.selectedColumns=[...xt],this.runsExpanded={},this.runsPinned=[],this.runsHidden=[],this.isComparingRuns=!1,this.compareRunCharts=void 0}}const Rt={compareRunCharts:{serializeQueryString:e=>btoa(JSON.stringify(e)),deserializeQueryString(e){try{const t=JSON.parse(atob(e));if(!Array.isArray(t))return;return t}catch{return}}},isComparingRuns:{serializeLocalStorage:()=>!1}},St=()=>(0,_.c)(),kt=Object.keys(new Et),wt=(e,t,r,n)=>{if("value"===n){if("true"===e)return!0;if("false"===e)return!1;if(void 0===e)return""}return t(e)},Mt=(e,t)=>Object.assign(new Et,{...e,...t});function Bt(e,t){const r=Ct.Z.getStoreForComponent("ExperimentPage",t),n=St()?(e=>{const t={...e};for(const n of Object.keys(t)){var r;const e=null===(r=Rt[n])||void 0===r?void 0:r.serializeLocalStorage;e&&(t[n]=e(t[n]))}return t})(e):e;r.saveComponentState(n)}function Tt(e){const t=St()?(e=>{const t={...e};for(const n of Object.keys(t)){var r;const e=null===(r=Rt[n])||void 0===r?void 0:r.serializeQueryString;e&&(t[n]=e(t[n]))}return t})(e):e;return ut().stringify(t,{addQueryPrefix:!0,arrayFormat:"comma",encodeValuesOnly:!0})}function It(e,t){let r=new Et;try{const e=Ct.Z.getStoreForComponent("ExperimentPage",t).loadComponentState();if((!(n=e).runsExpanded||(0,c.isObject)(n.runsExpanded))&&(!n.selectedColumns||(0,c.isArray)(n.selectedColumns))){const t=St()?(e=>{const t={...e};for(const n of Object.keys(t)){var r;const e=null===(r=Rt[n])||void 0===r?void 0:r.deserializeLocalStorage;e&&(t[n]=e(t[n]))}return t})(e):e;r=Mt(r,t)}}catch{l.Z.logErrorAndNotifyUser(`Error: malformed persisted search state for experiment(s) ${t}`)}var n;const a=decodeURIComponent(e),i=ut().parse(a,{ignoreQueryPrefix:!0,comma:!0,arrayLimit:500,decoder:wt}),{restData:s,stateData:o}=function(e){const t={},r={};for(const n in e)if(e.hasOwnProperty(n)){const a=kt.includes(n);Object.assign(a?t:r,{[n]:e[n]})}return{stateData:t,restData:r}}(i),d=St()?(e=>{const t={...e};for(const n of Object.keys(t)){var r;const e=null===(r=Rt[n])||void 0===r?void 0:r.deserializeQueryString;e&&(t[n]=e(t[n]))}return t})(o):o;if(!(Object.keys(d).length<1)){const e=Object.assign(new Et,d);r=Mt(r,e)}return Bt(r,t),(0,_.c)()||(r.isComparingRuns=!1),{state:r,queryString:Tt({...s,...r})}}const Lt=(0,n.createContext)(null),At=e=>{let{children:t,actions:r}=e;const a=(0,tt.k6)(),i=pt(),s=p(),[o,u]=(0,n.useState)(""),[m,g]=(0,n.useState)(!1),[v,f]=(0,n.useState)(!1),[y,C]=(0,n.useState)(null),x=(0,n.useMemo)((()=>JSON.stringify(i.sort())),[i]),[b,Z]=(0,n.useState)((()=>{const{queryString:e,state:t}=It(a.location.search,x);return a.location.search!==e&&a.replace(`${a.location.pathname}${e}`),t})),E=(0,n.useRef)([]),R=(0,n.useRef)(""),S=(0,n.useRef)(""),k=(0,n.useRef)(!0),w=(0,n.useCallback)((()=>k.current),[]),M=(0,n.useCallback)((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),a=arguments.length>3?arguments[3]:void 0;const i=Boolean(a);i||(S.current=n);const o=i?r.loadMoreRunsApi:r.searchRunsApi,c=o(ft(t,e,n,a||void 0));g(!0),s(c).then((e=>{const{value:t}=e;R.current=t.next_page_token,f(Boolean(t.next_page_token)),yt(t.runs||[],r.searchModelVersionsApi,s),E.current.some((e=>e.id===c.meta.id&&!e.active))&&g(!1)})).catch((e=>{l.Z.logErrorAndNotifyUser(e,0),g(!1)})),u(c.meta.id)}),[s,r]),B=(0,n.useCallback)((()=>{M(b,i,S.current||void 0,R.current||void 0)}),[M,b,i]),T=(0,n.useCallback)((()=>{M(b,i)}),[i,M,b]),I=(0,n.useCallback)(((e,t)=>{const r=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=ut().parse(r,{ignoreQueryPrefix:!0,comma:!0,arrayLimit:500,decoder:wt}),{experiments:a}=n;return Bt(e,t),Tt({experiments:a,...e})}(e,x,a.location.search);if(a.location.search!==r){const e=`${a.location.pathname}${r}`;t?a.replace(e):a.push(e)}}),[a,x]),L=(0,n.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{forceRefresh:r=!1,preservePristine:n=!1,replaceHistory:a=!1}=t;Z((t=>{const n=(0,c.isFunction)(e)?e(t):{...t,...e};return(r||vt(t,n))&&M(n,i),I(n,a),n})),n||(k.current=!1)}),[i,M,I]);(0,n.useEffect)((()=>a.listen(((e,t)=>{if("POP"===t){const{state:t}=It(e.search,x);L(t)}}))),[a,x,L]);const A=(0,n.useMemo)((()=>({actions:r,searchFacetsState:b,fetchExperimentRuns:T,updateSearchFacets:L,loadMoreRuns:B,requestError:y,isLoadingRuns:m,moreRunsAvailable:v,isPristine:w})),[r,b,T,B,y,m,L,v,w]);return(0,h.tZ)(Lt.Provider,{value:A,children:(0,h.tZ)(d.ZP,{shouldOptimisticallyRender:!0,requestIds:o?[o]:[],children:(e,r,n)=>(E.current=n,n.forEach((e=>{C(e.error)})),t)})})},Dt=()=>{const e=(0,n.useContext)(Lt);if(!e)throw new Error("Trying to use SearchExperimentRunsContext actions outside of the context!");return e},Nt=e=>{let{showDeleteRunModal:t,showRestoreRunModal:r,showRenameRunModal:a,runsSelected:i,onCloseDeleteRunModal:s,onCloseRestoreRunModal:o,onCloseRenameRunModal:l,renamedRunName:c}=e;const{updateSearchFacets:d}=Dt(),u=Object.entries(i).filter((e=>{let[,t]=e;return t})).map((e=>{let[t]=e;return t})),p=(0,n.useCallback)((()=>d({},{forceRefresh:!0,preservePristine:!0})),[d]);return(0,h.BX)(h.HY,{children:[(0,h.tZ)(it,{isOpen:t,onClose:s,selectedRunIds:u}),(0,h.tZ)(ct,{isOpen:r,onClose:o,selectedRunIds:u}),(0,h.tZ)(st.UQ,{runUuid:u[0],onClose:l,runName:c,isOpen:a,onSuccess:()=>p()})]})},Ot=e=>{let{children:t}=e;return(0,h.tZ)(h.HY,{children:t})},Pt=n.memo((e=>{let{viewState:t,runsData:r,searchFacetsState:a,updateSearchFacets:i}=e;const{runsSelected:o}=t,{runInfos:l}=r,{lifecycleFilter:c,startTime:d}=a,u=(0,tt.k6)(),p=s(),m=(0,n.useMemo)((()=>(e=>({ALL:e.formatMessage({id:"a/TbnY",defaultMessage:"All time"}),LAST_HOUR:e.formatMessage({id:"bjoGjg",defaultMessage:"Last hour"}),LAST_24_HOURS:e.formatMessage({id:"JChRnq",defaultMessage:"Last 24 hours"}),LAST_7_DAYS:e.formatMessage({id:"eQsXm7",defaultMessage:"Last 7 days"}),LAST_30_DAYS:e.formatMessage({id:"p1H1KR",defaultMessage:"Last 30 days"}),LAST_YEAR:e.formatMessage({id:"EI7moF",defaultMessage:"Last year"})}))(p)),[p]),[g,f]=(0,n.useState)(!1),[y,C]=(0,n.useState)(!1),[x,Z]=(0,n.useState)(!1),[R,S]=(0,n.useState)(""),k=(0,n.useCallback)((()=>{const e=Object.keys(o),t=l.find((t=>t.run_uuid===e[0]));t&&(S(t.run_name),Z(!0))}),[l,o]),w=(0,n.useCallback)((()=>{const e=Object.keys(o),t=l.filter((t=>{let{run_uuid:r}=t;return e.includes(r)})).map((e=>{let{experiment_id:t}=e;return t}));u.push(se.Z.getCompareRunPageRoute(e,[...new Set(t)].sort()))}),[u,l,o]),M=(0,n.useCallback)((()=>f(!0)),[]),B=(0,n.useCallback)((()=>C(!0)),[]),T=(0,n.useCallback)((()=>f(!1)),[]),I=(0,n.useCallback)((()=>C(!1)),[]),L=(0,n.useCallback)((()=>Z(!1)),[]),A=Object.values(t.runsSelected).filter(Boolean).length,D=A>0,N=1===A,O=A>1,P=O||N||D,U=(0,h.BX)(h.HY,{children:[(0,h.tZ)(E.Z,{id:"OGWg8l",defaultMessage:"State:"})," ",c]}),H=(0,h.BX)(h.HY,{children:[(0,h.tZ)(E.Z,{id:"+fb25b",defaultMessage:"Time created"}),": ",m[d]]});return(0,h.BX)("div",{css:Ut.controlBar,children:[(0,h.tZ)(Nt,{runsSelected:o,onCloseRenameRunModal:L,onCloseDeleteRunModal:T,onCloseRestoreRunModal:I,showDeleteRunModal:g,showRestoreRunModal:y,showRenameRunModal:x,renamedRunName:R}),!P&&(0,h.BX)(h.HY,{children:[(0,h.tZ)(v.PhF,{className:"start-time-select",value:{value:d,label:H},labelInValue:!0,onChange:e=>{let{value:t}=e;i({startTime:t})},"data-test-id":"start-time-select-dropdown",dangerouslySetAntdProps:{virtual:!1},children:Object.keys(m).map((e=>(0,h.tZ)(v.Wxm,{title:m[e],"data-test-id":`start-time-select-${e}`,value:e,children:m[e]},e)))}),(0,h.BX)(v.PhF,{value:{value:c,label:U},labelInValue:!0,"data-testid":"lifecycle-filter",onChange:e=>{let{value:t}=e;return i({lifecycleFilter:t})},children:[(0,h.tZ)(v.PhF.Option,{"data-testid":"active-runs-menu-item",value:G.VW.ACTIVE,children:(0,h.tZ)(E.Z,{id:"0pdAuV",defaultMessage:"Active"})}),(0,h.tZ)(v.PhF.Option,{"data-testid":"deleted-runs-menu-item",value:G.VW.DELETED,children:(0,h.tZ)(E.Z,{id:"yJpGwW",defaultMessage:"Deleted"})})]})]}),P&&(0,h.BX)(h.HY,{children:[(0,h.tZ)(b.B,{"data-testid":"run-rename-button",onClick:k,disabled:!N,children:(0,h.tZ)(E.Z,{id:"oWPgX7",defaultMessage:"Rename"})}),c===G.VW.ACTIVE?(0,h.tZ)(b.B,{"data-testid":"runs-delete-button",disabled:!D,onClick:M,danger:!0,children:(0,h.tZ)(E.Z,{id:"3Rb4sG",defaultMessage:"Delete"})}):null,c===G.VW.DELETED?(0,h.tZ)(b.B,{"data-testid":"runs-restore-button",disabled:!D,onClick:B,children:(0,h.tZ)(E.Z,{id:"Potju2",defaultMessage:"Restore"})}):null,(0,h.tZ)("div",{css:Ut.buttonSeparator}),(0,h.tZ)(Ot,{children:(0,h.tZ)(b.B,{"data-testid":"runs-compare-button",disabled:!O,onClick:w,children:(0,h.tZ)(E.Z,{id:"RaGnOQ",defaultMessage:"Compare"})})})]})]})})),Ut={groupSeparator:()=>({flex:1}),buttonSeparator:e=>({borderLeft:`1px solid ${e.colors.border}`,marginLeft:e.spacing.xs,marginRight:e.spacing.xs,height:"100%"}),controlBar:e=>({display:"flex",gap:e.spacing.sm,alignItems:"center",paddingTop:e.spacing.sm,borderTop:`1px solid ${e.colors.border}`})};var Ht=r(4942),Ft=r(71002),_t=r(87462),Kt=r(58804),Xt=r(43270),Wt=r.n(Xt),$t=r(25831),zt=r(90690),Vt=r(29439);function jt(e){var t,r=e.prefixCls,a=e.value,i=e.current,s=e.offset,o=void 0===s?0:s;return o&&(t={position:"absolute",top:"".concat(o,"00%"),left:0}),n.createElement("span",{style:t,className:Wt()("".concat(r,"-only-unit"),{current:i})},a)}function Yt(e,t,r){for(var n=e,a=0;(n+10)%10!==t;)n+=r,a+=r;return a}function qt(e){var t,r,a=e.prefixCls,i=e.count,s=e.value,o=Number(s),l=Math.abs(i),c=n.useState(o),d=(0,Vt.Z)(c,2),u=d[0],p=d[1],h=n.useState(l),m=(0,Vt.Z)(h,2),g=m[0],v=m[1],f=function(){p(o),v(l)};if(n.useEffect((function(){var e=setTimeout((function(){f()}),1e3);return function(){clearTimeout(e)}}),[o]),u===o||Number.isNaN(o)||Number.isNaN(u))t=[n.createElement(jt,(0,_t.Z)({},e,{key:o,current:!0}))],r={transition:"none"};else{t=[];for(var y=o+10,C=[],x=o;x<=y;x+=1)C.push(x);var b=C.findIndex((function(e){return e%10===u}));t=C.map((function(t,r){var a=t%10;return n.createElement(jt,(0,_t.Z)({},e,{key:t,value:a,offset:r-b,current:r===b}))})),r={transform:"translateY(".concat(-Yt(u,o,g<l?1:-1),"00%)")}}return n.createElement("span",{className:"".concat(a,"-only"),style:r,onTransitionEnd:f},t)}var Gt=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},Qt=function(e){var t=e.prefixCls,r=e.count,a=e.className,i=e.motionClassName,s=e.style,o=e.title,l=e.show,c=e.component,d=void 0===c?"sup":c,u=e.children,p=Gt(e,["prefixCls","count","className","motionClassName","style","title","show","component","children"]),h=(0,n.useContext($t.E_).getPrefixCls)("scroll-number",t),m=(0,_t.Z)((0,_t.Z)({},p),{"data-show":l,style:s,className:Wt()(h,a,i),title:o}),g=r;if(r&&Number(r)%1===0){var v=String(r).split("");g=v.map((function(e,t){return n.createElement(qt,{prefixCls:h,count:Number(r),value:e,key:v.length-t})}))}return s&&s.borderColor&&(m.style=(0,_t.Z)((0,_t.Z)({},s),{boxShadow:"0 0 0 1px ".concat(s.borderColor," inset")})),u?(0,zt.Tm)(u,(function(e){return{className:Wt()("".concat(h,"-custom-component"),null===e||void 0===e?void 0:e.className,i)}})):n.createElement(d,m,g)},Jt=r(71235);function er(e){return-1!==Jt.Y.indexOf(e)}var tr=function(e){var t,r=e.className,a=e.prefixCls,i=e.style,s=e.color,o=e.children,l=e.text,c=e.placement,d=void 0===c?"end":c,u=n.useContext($t.E_),p=u.getPrefixCls,h=u.direction,m=p("ribbon",a),g=er(s),v=Wt()(m,"".concat(m,"-placement-").concat(d),(t={},(0,Ht.Z)(t,"".concat(m,"-rtl"),"rtl"===h),(0,Ht.Z)(t,"".concat(m,"-color-").concat(s),g),t),r),f={},y={};return s&&!g&&(f.background=s,y.color=s),n.createElement("div",{className:"".concat(m,"-wrapper")},o,n.createElement("div",{className:v,style:(0,_t.Z)((0,_t.Z)({},f),i)},n.createElement("span",{className:"".concat(m,"-text")},l),n.createElement("div",{className:"".concat(m,"-corner"),style:y})))},rr=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},nr=function(e){var t,r,a=e.prefixCls,i=e.scrollNumberPrefixCls,s=e.children,o=e.status,l=e.text,c=e.color,d=e.count,u=void 0===d?null:d,p=e.overflowCount,h=void 0===p?99:p,m=e.dot,g=void 0!==m&&m,v=e.size,f=void 0===v?"default":v,y=e.title,C=e.offset,x=e.style,b=e.className,Z=e.showZero,E=void 0!==Z&&Z,R=rr(e,["prefixCls","scrollNumberPrefixCls","children","status","text","color","count","overflowCount","dot","size","title","offset","style","className","showZero"]),S=n.useContext($t.E_),k=S.getPrefixCls,w=S.direction,M=k("badge",a),B=u>h?"".concat(h,"+"):u,T=null!==o&&void 0!==o||null!==c&&void 0!==c,I="0"===B||0===B,L=g&&!I||T,A=L?"":B,D=(0,n.useMemo)((function(){return(null===A||void 0===A||""===A||I&&!E)&&!L}),[A,I,E,L]),N=(0,n.useRef)(u);D||(N.current=u);var O=N.current,P=(0,n.useRef)(A);D||(P.current=A);var U=P.current,H=(0,n.useRef)(L);D||(H.current=L);var F=(0,n.useMemo)((function(){if(!C)return(0,_t.Z)({},x);var e={marginTop:C[1]};return"rtl"===w?e.left=parseInt(C[0],10):e.right=-parseInt(C[0],10),(0,_t.Z)((0,_t.Z)({},e),x)}),[w,C,x]),_=null!==y&&void 0!==y?y:"string"===typeof O||"number"===typeof O?O:void 0,K=D||!l?null:n.createElement("span",{className:"".concat(M,"-status-text")},l),X=O&&"object"===(0,Ft.Z)(O)?(0,zt.Tm)(O,(function(e){return{style:(0,_t.Z)((0,_t.Z)({},F),e.style)}})):void 0,W=Wt()((t={},(0,Ht.Z)(t,"".concat(M,"-status-dot"),T),(0,Ht.Z)(t,"".concat(M,"-status-").concat(o),!!o),(0,Ht.Z)(t,"".concat(M,"-status-").concat(c),er(c)),t)),$={};c&&!er(c)&&($.background=c);var z=Wt()(M,(r={},(0,Ht.Z)(r,"".concat(M,"-status"),T),(0,Ht.Z)(r,"".concat(M,"-not-a-wrapper"),!s),(0,Ht.Z)(r,"".concat(M,"-rtl"),"rtl"===w),r),b);if(!s&&T){var V=F.color;return n.createElement("span",(0,_t.Z)({},R,{className:z,style:F}),n.createElement("span",{className:W,style:$}),n.createElement("span",{style:{color:V},className:"".concat(M,"-status-text")},l))}return n.createElement("span",(0,_t.Z)({},R,{className:z}),s,n.createElement(Kt.Z,{visible:!D,motionName:"".concat(M,"-zoom"),motionAppear:!1},(function(e){var t,r=e.className,a=k("scroll-number",i),s=H.current,l=Wt()((t={},(0,Ht.Z)(t,"".concat(M,"-dot"),s),(0,Ht.Z)(t,"".concat(M,"-count"),!s),(0,Ht.Z)(t,"".concat(M,"-count-sm"),"small"===f),(0,Ht.Z)(t,"".concat(M,"-multiple-words"),!s&&U&&U.toString().length>1),(0,Ht.Z)(t,"".concat(M,"-status-").concat(o),!!o),(0,Ht.Z)(t,"".concat(M,"-status-").concat(c),er(c)),t)),d=(0,_t.Z)({},F);return c&&!er(c)&&((d=d||{}).background=c),n.createElement(Qt,{prefixCls:a,show:!D,motionClassName:r,className:l,count:U,title:_,style:d,key:"scrollNumber"},X)})),K)};nr.Ribbon=tr;var ar=nr;const ir=n.memo((e=>{let{runInfos:t}=e;const{actions:{searchRunsPayload:r},updateSearchFacets:a}=Dt(),i=pt(),[s,o]=(0,n.useState)(0),[l,c]=(0,n.useState)(0),d=(0,n.useCallback)((()=>a({},{forceRefresh:!0,preservePristine:!0})),[a]);return(0,n.useEffect)((()=>{c(0),o((()=>Date.now()))}),[t]),(0,n.useEffect)((()=>{if(!s)return;const e=setInterval((()=>{const e={experimentIds:i,filter:`attributes.start_time > ${s}`,maxResults:G.mz};r(e).then((e=>{var t;const r=(null===(t=e.runs)||void 0===t?void 0:t.length)||0;c(r)}))}),G.FK);return()=>clearInterval(e)}),[s,r,i]),(0,h.tZ)(ar,{count:l,offset:[-5,5],css:sr.pill,overflowCount:G.mz-1,children:(0,h.tZ)(b.B,{onClick:d,"data-testid":"runs-refresh-button",icon:(0,h.tZ)(v.bnu,{}),children:(0,h.tZ)(E.Z,{id:"ag05Pe",defaultMessage:"Refresh"})})})})),sr={pill:e=>({sup:{backgroundColor:e.colors.lime,zIndex:1}})},or=(0,u.$j)((e=>({runInfos:e.entities.runInfosByUuid})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.runInfosByUuid===t.entities.runInfosByUuid})(ir),lr="GROUP",cr=Ke(lr,G.D5.ATTRIBUTES),dr=Ke(lr,G.D5.PARAMS),ur=Ke(lr,G.D5.METRICS),pr=Ke(lr,G.D5.TAGS),hr=[G.z.USER,G.z.SOURCE,G.z.VERSION,G.z.MODELS],mr=[G.z.EXPERIMENT_NAME,...hr],gr=(e,t)=>e.filter((e=>e.toLowerCase().includes(t.toLowerCase()))),vr=(e,t)=>{if(!t)return e;const r=e.toLowerCase().indexOf(t.toLowerCase()),n=e.substring(0,r),a=e.substring(r,r+t.length),i=e.substring(r+t.length);return r>-1?(0,h.BX)("span",{children:[n,(0,h.tZ)("strong",{children:a}),i]}):e},fr=n.memo((e=>{let{runsData:t,columnSelectorVisible:r,onChangeColumnSelectorVisible:a,updateSearchFacets:i,selectedColumns:s}=e;const o=pt(),[c,d]=(0,n.useState)(""),u=(0,n.useRef)(null),p=(0,n.useRef)(null),m=(0,n.useRef)(null),g=(0,n.useMemo)((()=>o.length>1?mr:hr),[o.length]),f=(0,n.useCallback)((e=>i((t=>{const r=e(t.selectedColumns),n=Array.from(new Set(r));return{...t,selectedColumns:n}}))),[i]),y=(0,n.useMemo)((()=>l.Z.getVisibleTagKeyList(t.tagsList)),[t]),C=(0,n.useMemo)((()=>({[G.D5.ATTRIBUTES]:g.map((e=>Ke(G.D5.ATTRIBUTES,e))),[G.D5.PARAMS]:t.paramKeyList.map((e=>Ke(G.D5.PARAMS,e))),[G.D5.METRICS]:t.metricKeyList.map((e=>Ke(G.D5.METRICS,e))),[G.D5.TAGS]:y.map((e=>Ke(G.D5.TAGS,e)))})),[t,g,y]),x=(0,n.useMemo)((()=>{const e=[],r=gr(g,c),n=gr(t.paramKeyList,c),a=gr(t.metricKeyList,c),i=gr(y,c);return r.length&&e.push({key:cr,title:"Attributes",children:r.map((e=>({key:Ke(G.D5.ATTRIBUTES,e),title:vr(e,c)})))}),a.length&&e.push({key:ur,title:`Metrics (${a.length})`,children:a.map((e=>({key:Ke(G.D5.METRICS,e),title:vr(e,c)})))}),n.length&&e.push({key:dr,title:`Parameters (${n.length})`,children:n.map((e=>({key:Ke(G.D5.PARAMS,e),title:vr(e,c)})))}),i.length&&e.push({key:pr,title:`Tags (${i.length})`,children:i.map((e=>({key:Ke(G.D5.TAGS,e),title:e})))}),e}),[g,c,t,y]),Z=(0,n.useCallback)(((e,t)=>{f(e?e=>e.filter((e=>!t.includes(e))):e=>[...e,...t])}),[f]),R=(0,n.useCallback)(((e,t)=>{f(t?t=>t.filter((t=>t!==e)):t=>[...t,e])}),[f]);(0,n.useEffect)((()=>{r&&(d(""),requestAnimationFrame((()=>{var e,t;null===p||void 0===p||null===(e=p.current)||void 0===e||e.scrollTo(0,0),null===(t=u.current)||void 0===t||t.focus({preventScroll:!0}),m.current&&m.current.scrollIntoView({block:"nearest",behavior:"smooth"})})))}),[r]);const S=(0,n.useCallback)(((e,t)=>{let{node:{key:r,checked:n}}=t;if(Xe(r.toString(),lr)){const e=We(r.toString(),lr),t=C[e];t&&Z(n,gr(t,c))}else R(r.toString(),n)}),[C,Z,R,c]),k=(0,n.useCallback)((e=>{if("ArrowDown"===e.key){const e=(null===(t=p.current)||void 0===t?void 0:t.querySelector('[role="tree"] input'))||null;e&&e.focus()}var t}),[]),w=(0,h.BX)("div",{css:Cr.dropdown,children:[(0,h.tZ)("div",{css:e=>({padding:e.spacing.md}),children:(0,h.tZ)(b.h,{value:c,prefix:(0,h.tZ)(b.x,{}),placeholder:"Search columns",allowClear:!0,ref:u,onChange:e=>{d(e.target.value)},onKeyDown:k})}),(0,h.tZ)("div",{ref:p,css:Cr.scrollableContainer,children:(0,h.tZ)(v.mpN,{"data-testid":"column-selector-tree",mode:"checkable",dangerouslySetAntdProps:{checkedKeys:s,onCheck:S},defaultExpandedKeys:[cr,dr,ur,pr],treeData:x})})]});return(0,h.tZ)(v.Ltx,{overlay:w,placement:"bottomRight",trigger:["click"],visible:r,onVisibleChange:a,children:(0,h.BX)(b.B,{ref:m,style:{display:"flex",alignItems:"center"},"data-testid":"column-selection-dropdown",icon:(0,h.tZ)(v.DE2,{}),children:[(0,h.tZ)(E.Z,{id:"ny+fBZ",defaultMessage:"Columns"})," ",(0,h.tZ)(b.C,{})]})})})),yr=e=>{const{updateSearchFacets:t,searchFacetsState:r}=Dt();return(0,h.tZ)(fr,{...e,selectedColumns:r.selectedColumns,updateSearchFacets:t})},Cr={dropdown:e=>({backgroundColor:e.colors.white,width:400,border:"1px solid",borderColor:e.colors.border}),scrollableContainer:e=>({maxHeight:480,overflowY:"scroll",overflowX:"hidden",paddingBottom:e.spacing.md,"span[title]":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}})},xr=e=>{let{isComparingRuns:t,setIsComparingRuns:r}=e;return(0,h.BX)(v.Xzw,{value:t?"COMPARE":"LIST",onChange:e=>{let{target:{value:t}}=e;r("COMPARE"===t)},children:[(0,h.BX)(v.HeI,{value:"LIST","data-testid":"experiment-runs-mode-switch-list",children:[(0,h.tZ)(v.eoG,{})," ",(0,h.tZ)(E.Z,{id:"Uw3UMI",defaultMessage:"Table view"})]}),(0,h.BX)(v.HeI,{value:"COMPARE","data-testid":"experiment-runs-mode-switch-compare",children:[(0,h.tZ)(v.eJP,{})," ",(0,h.tZ)(E.Z,{id:"DYvd0s",defaultMessage:"Chart view"})]})]})};var br=r(17564);var Zr={name:"1j5vobt",styles:"display:flex;align-items:center;gap:4px"};const Er=n.memo((e=>{let{searchFacetsState:t,sortOptions:r,onSortKeyChanged:a}=e;const{orderByKey:i,orderByAsc:s}=t,o=(0,n.useMemo)((()=>`${i}${G.T_}${s?G.aU:G.iX}`),[s,i]),l=(0,n.useMemo)((()=>{const e=r.find((e=>e.value===o));let t=null===e||void 0===e?void 0:e.label;if(!t){const e=i.match(/^.+\.`(.+)`$/);e&&(t=e[1])}return(0,h.BX)("span",{css:Zr,children:[s?(0,h.tZ)(b.y,{}):(0,h.tZ)(b.z,{})," ",(0,h.tZ)(E.Z,{id:"llrWuc",defaultMessage:"Sort"}),": ",t]})}),[o,s,i,r]);return(0,h.tZ)(v.PhF,{className:"sort-select",css:Rr.sortSelectControl,value:{value:o,label:l},labelInValue:!0,dangerouslySetAntdProps:{virtual:!1,dropdownStyle:Rr.sortSelectDropdown},onChange:a,"data-test-id":"sort-select-dropdown",children:r.map((e=>(0,h.BX)(v.Wxm,{title:e.label,"data-test-id":`sort-select-${e.label}-${e.order}`,value:e.value,children:[(0,h.tZ)("span",{css:Rr.sortMenuArrowWrapper,children:e.order===G.aU?(0,h.tZ)(v.Hf3,{}):(0,h.tZ)(v.veu,{})})," ",(0,br.mJ)(e.label,50)]},e.value)))})})),Rr={sortSelectControl:{minWidth:140,maxWidth:360},sortSelectDropdown:{minWidth:360},sortMenuArrowWrapper:{svg:{width:12,height:12}}},Sr=()=>(0,h.BX)("div",{className:"search-input-tooltip-content",children:[(0,h.tZ)(E.Z,{id:"kIlkgf",defaultMessage:"Search runs using a simplified version of the SQL {whereBold} clause.",values:{whereBold:(0,h.tZ)("b",{children:"WHERE"})}})," ",(0,h.tZ)(E.Z,{id:"nYKZy4",defaultMessage:"<link>Learn more</link>",values:{link:e=>(0,h.tZ)("a",{href:f.Kp,target:"_blank",rel:"noopener noreferrer",children:e})}}),(0,h.tZ)("br",{}),(0,h.tZ)(E.Z,{id:"U3btBc",defaultMessage:"Examples:"}),(0,h.tZ)("br",{}),"\u2022 metrics.rmse >= 0.8",(0,h.tZ)("br",{}),"\u2022 metrics.`f1 score` < 1",(0,h.tZ)("br",{}),"\u2022 params.model = 'tree'",(0,h.tZ)("br",{}),"\u2022 attributes.run_name = 'my run'",(0,h.tZ)("br",{}),"\u2022 tags.`mlflow.user` = 'myUser'",(0,h.tZ)("br",{}),"\u2022 metric.f1_score > 0.9 AND params.model = 'tree'",(0,h.tZ)("br",{}),"\u2022 attributes.run_id IN ('a1b2c3d4', 'e5f6g7h8')",(0,h.tZ)("br",{}),"\u2022 tags.model_class LIKE 'sklearn.linear_model%'"]});const kr=["run_id","run_name","status","artifact_uri","user_id","start_time","end_time","created"].map((e=>({value:`attributes.${e}`})));var wr={name:"lugakg",styles:"font-weight:normal"};const Mr=(e,t)=>{const r=e.split(RegExp(t.replace(".","\\."),"ig")),n=e.match(RegExp(t.replace(".","\\."),"ig"));return(0,h.tZ)("span",{css:wr,"data-test-id":e,children:r.map(((e,t)=>(0,h.BX)(h.HY,{children:[e,t!==r.length-1&&n&&(0,h.tZ)("b",{children:n[t]})]})))})};const Br="tooltipLastPopup";var Tr={name:"1ua1wyk",styles:"width:560px"};const Ir=e=>{const{runsData:t,searchFacetsState:r,updateSearchFacets:a,requestError:i}=e,[s,o]=(0,n.useState)(""),[l,d]=(0,n.useState)(void 0),[u,p]=(0,n.useState)(!1),[m,g]=(0,n.useState)(!1),f=(0,n.useRef)(t),[y,C]=(0,n.useState)({Metrics:10,Parameters:10,Tags:10}),x=(0,n.useRef)([]),[Z,E]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{o(r.searchFilter)}),[r]);const R=(0,n.useMemo)((()=>{const e=f.current;return f.current=t,((e,t)=>{const r=(e,t)=>[...new Set([...e,...t])],n=e=>e.flatMap((e=>Object.keys(e))),a=r(e.metricKeyList,t.metricKeyList),i=r(e.paramKeyList,t.paramKeyList),s=r(n(e.tagsList),n(t.tagsList)).filter((e=>!e.startsWith("mlflow."))).map((e=>e.includes('"')||e.includes(" ")||e.includes(".")?`\`${e}\``:e.includes("`")?`"${e}"`:e));return[{label:"Metrics",options:a.map((e=>({value:`metrics.${e}`})))},{label:"Parameters",options:i.map((e=>({value:`params.${e}`})))},{label:"Tags",options:s.map((e=>({value:`tags.${e}`})))},{label:"Attributes",options:kr}]})(e,t)}),[t]);(0,n.useEffect)((()=>{const e=x.current,t=(e=>{const t=/>|<|>=|<=|=|!=|like|ilike/gi,r=(e=>{const t=/and[\s]+/gi,r=[];let n,a;for(;a=t.lastIndex,n=t.exec(e);)r.push({clause:e.substring(a,n.index),startIndex:a});return r.push({clause:e.substring(a),startIndex:a}),r})(e),n=[];return r.forEach((e=>{const r=e.clause.split(t)[0],{startIndex:a}=e;n.push({name:r,startIndex:0+a,endIndex:r.length+a})})),n})(s);if(x.current=t,m)return void g(!1);const r=t.map((e=>e.name)),n=e.map((e=>e.name));if(!(0,c.isEqual)(r,n)&&t.length>=e.length){let r=0;for(;r<t.length;){if(r>=e.length||t[r].name.trim()!==e[r].name.trim())return d(!0),void E(t[r]);r++}}d(!1)}),[s]);const S=(0,n.useMemo)((()=>Z?((e,t,r)=>e.map((e=>{const n=e.options.filter((e=>e.value.toLowerCase().includes(t.name.toLowerCase().trim()))).map((e=>({value:e.value,label:Mr(e.value,t.name.trim())}))),a=r[e.label],i=[...n.slice(0,a),...n.length>a?[{label:"...",value:`..._${e.label}`}]:[]];return{label:e.label,options:i}})).filter((e=>e.options.length>0)))(R,Z,y):[]),[R,Z,y]),k=(0,n.useCallback)(((e,t)=>{if(Z)if(e.startsWith("...")){d(!0);const e=t.value.split("_")[1];C((t=>({...t,[e]:t[e]+10})))}else{const t=s.substring(0,Z.startIndex),r=s.substring(Z.endIndex);o(t+e+" "+r),g(!0),d(!1)}}),[s,o,Z,d]),w=(0,n.useCallback)((()=>{a(bt)}),[a]),M=(B=Br,(0,n.useMemo)((()=>Ct.Z.getStoreForComponent("ExperimentView",B)),[B]));var B;const[T,I]=(0,n.useState)((()=>{const e=Math.floor(Date.now()/1e3),t=M.getItem(Br);return!t||parseInt(t,10)<e-604800})),L=n.useRef(null);(0,n.useEffect)((()=>{if(i&&T){var e;const t=Math.floor(Date.now()/1e3);M.setItem(Br,t),I(!1),null===(e=L.current)||void 0===e||e.click()}}),[i]);const A=0===S.flatMap((e=>e.options)).length,D=l&&u&&!A,N=(0,n.useCallback)((e=>{"Enter"===e.key&&(D?d(!1):a({searchFilter:s})),"Escape"===e.key&&(e.preventDefault(),D&&d(!1))}),[D,s,a]);return(0,h.tZ)("div",{css:Lr.searchBox,children:(0,h.tZ)(v.QcG,{dropdownMatchSelectWidth:560,css:Tr,defaultOpen:!1,defaultActiveFirstOption:!0,open:D,options:S,onSelect:k,value:s,"data-test-id":"runs-search-autocomplete",dropdownRender:e=>(0,h.tZ)("div",{css:Lr.dropdownOverride,children:e}),children:(0,h.tZ)(b.h,{value:s,prefix:(0,h.tZ)(b.x,{css:Lr.searchBarIcon}),onKeyDown:N,onClick:()=>p(!0),onBlur:()=>p(!1),onChange:e=>o(e.target.value),placeholder:'metrics.rmse < 1 and params.model = "tree"',"data-test-id":"search-box",suffix:(0,h.BX)("div",{css:Lr.searchInputSuffix,children:[s&&(0,h.tZ)(b.B,{onClick:w,type:"link","data-test-id":"clear-button",children:(0,h.tZ)(b.b,{})}),(0,h.tZ)(b.e,{title:(0,h.tZ)(Sr,{}),placement:"right",dangerouslySetAntdProps:{overlayInnerStyle:{width:"150%"},trigger:"click"},children:(0,h.tZ)("div",{ref:L,children:(0,h.tZ)(v.szr,{css:Lr.searchBarIcon})})})]})})})})},Lr={searchBox:e=>({display:"flex",gap:e.spacing.sm,width:560}),searchBarIcon:e=>({svg:{width:16,height:16,color:e.colors.textSecondary}}),searchInputSuffix:{display:"flex",gap:4,alignItems:"center"},dropdownOverride:{".du-bois-light-select-item-option-active:not(.du-bois-light-select-item-option-disabled)":{backgroundColor:"#e6f1f5"}}},Ar=n.memo((e=>{let{searchFacetsState:t,updateSearchFacets:r,runsData:a,viewState:i,updateViewState:s,onDownloadCsv:o,sortOptions:l,requestError:c}=e;const{isComparingRuns:d}=t,u=(0,n.useCallback)((e=>{let{value:t}=e;const[n,a]=t.split(G.T_),i=je[n]||n,s=a===G.aU;r((e=>{const{selectedColumns:t}=e;return t.includes(i)||t.push(i),{...e,selectedColumns:t,orderByKey:n,orderByAsc:s}}))}),[r]),p=(0,n.useCallback)((e=>s({columnSelectorVisible:e})),[s]);return(0,h.tZ)(h.HY,{children:(0,h.BX)("div",{css:Dr.groupBar,children:[(0,h.BX)("div",{css:Dr.controlBar,children:[(0,_.c)()&&(0,h.tZ)(xr,{isComparingRuns:d,setIsComparingRuns:e=>r({isComparingRuns:e})}),(0,h.tZ)(Ir,{runsData:a,searchFacetsState:t,updateSearchFacets:r,requestError:c}),(0,h.tZ)(Er,{onSortKeyChanged:u,searchFacetsState:t,sortOptions:l}),!d&&(0,h.tZ)(yr,{columnSelectorVisible:i.columnSelectorVisible,onChangeColumnSelectorVisible:p,runsData:a})]}),(0,h.tZ)("div",{css:Dr.groupSeparator}),(0,h.BX)("div",{css:Dr.controlBar,children:[(0,h.tZ)(v.Ltx,{trigger:["click"],placement:"bottomRight",overlay:(0,h.tZ)(v.v2r,{children:(0,h.BX)(v.v2r.Item,{className:"csv-button",onClick:o,children:[(0,h.tZ)(v._8t,{})," ",(0,h.tZ)(E.Z,{id:"rOnjGB",defaultMessage:"Download CSV"})]})}),children:(0,h.tZ)(b.B,{type:"tertiary",icon:(0,h.tZ)(v.VZO,{})})}),(0,h.tZ)(or,{})]})]})})})),Dr={groupBar:{display:"grid",gridTemplateColumns:"auto 1fr auto"},controlBar:e=>({display:"flex",gap:e.spacing.sm,alignItems:"center",flexWrap:"wrap"}),groupSeparator:e=>({minWidth:e.spacing.sm}),columnSwitch:{margin:"5px"},searchBox:e=>({display:"flex",gap:e.spacing.sm,width:560}),lifecycleFilters:e=>({display:"flex",gap:8,alignItems:"center",marginTop:e.spacing.sm,marginBottom:e.spacing.sm,marginLeft:2*e.spacing.lg})},Nr=n.memo((e=>{let{runsData:t,viewState:r,updateViewState:a,updateSearchFacets:i,searchFacetsState:s,requestError:o}=e;const{paramKeyList:c,metricKeyList:d,tagsList:u}=t,p=c,m=d,g=l.Z.getVisibleTagKeyList(u),v=(0,n.useCallback)((()=>((e,t,r,n)=>{const{runInfos:a,paramsList:i,metricsList:s,tagsList:o}=e,l=ke({runInfos:a,paramKeyList:r,metricKeyList:n,tagKeyList:t,paramsList:i,metricsList:s,tagsList:o}),c=new Blob([l],{type:"application/csv;charset=utf-8"});(0,fe.saveAs)(c,"runs.csv")})(t,g,p,m)),[m,p,g,t]),f=((e,t)=>(0,n.useMemo)((()=>{let r=[];const n=[G.aU,G.iX];return r=[...Object.keys(G.Ul).reduce(((e,t)=>{const r=G.Ul[t];return n.forEach((n=>{e.push({label:r,value:G.XZ[t]+G.T_+n,order:n})})),e}),[]),...e.reduce(((e,t)=>(n.forEach((r=>{e.push({label:t,value:`${Ke(G.D5.METRICS,t)}${G.T_}${r}`,order:r})})),e)),[]),...t.reduce(((e,t)=>(n.forEach((r=>{e.push({label:t,value:`${Ke(G.D5.PARAMS,t)}${G.T_}${r}`,order:r})})),e)),[])],r}),[e,t]))(m,p);return(0,h.BX)("div",{css:Or.wrapper,children:[(0,h.tZ)(Ar,{onDownloadCsv:v,updateSearchFacets:i,searchFacetsState:s,viewState:r,updateViewState:a,sortOptions:f,runsData:t,requestError:o}),(0,h.tZ)(Pt,{runsData:t,updateSearchFacets:i,searchFacetsState:s,viewState:r})]})})),Or={wrapper:e=>({display:"flex",gap:e.spacing.sm,flexDirection:"column",marginTop:e.spacing.md,marginBottom:e.spacing.sm})},Pr=n.lazy((()=>Promise.all([r.e(547),r.e(869)]).then(r.bind(r,49869)))),Ur=e=>(0,h.tZ)(n.Suspense,{fallback:(0,h.tZ)("div",{css:e=>({display:"flex",justifyContent:"center",margin:e.spacing.md}),children:(0,h.tZ)(b.S,{})}),children:(0,h.tZ)(Pr,{...e})}),Hr=e=>{let{isFiltered:t,onClearFilters:r}=e;return(0,h.tZ)("div",{css:Fr.noResultsWrapper,children:(0,h.tZ)("div",{css:Fr.noResults,children:t?(0,h.tZ)(v.HYy,{button:(0,h.tZ)(b.B,{type:"primary",onClick:r,children:(0,h.tZ)(E.Z,{id:"pEpexK",defaultMessage:"Clear filters"})}),description:(0,h.tZ)(E.Z,{id:"Nnsm0p",defaultMessage:"All runs in this experiment have been filtered. Change or clear filters to view runs."}),title:(0,h.tZ)(E.Z,{id:"Tl63jz",defaultMessage:"All runs are filtered"}),image:(0,h.tZ)(v.k1n,{})}):(0,h.tZ)(v.HYy,{description:(0,h.tZ)(E.Z,{id:"coo35p",defaultMessage:"No runs have been logged yet. <link>Learn more</link> about how to create ML model training runs in this experiment.",values:{link:e=>(0,h.tZ)("a",{target:"_blank",href:f.gM,rel:"noreferrer",children:e})}}),title:(0,h.tZ)(E.Z,{id:"sByLVU",defaultMessage:"No runs logged"}),image:(0,h.tZ)(v.uOV,{})})})})},Fr={noResults:{maxWidth:360},noResultsWrapper:e=>({marginTop:e.spacing.lg,inset:0,backgroundColor:e.colors.backgroundPrimary,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"})},_r="is-out-of-viewport",Kr="is-hidden",Xr="is-minimized",Wr=".ag-root",$r=".ag-pinned-left-cols-container",zr=".ag-center-cols-container",Vr=".ag-header",jr=".ag-body-viewport",Yr=e=>{let{onClick:t,gridContainerElement:r,isInitialized:a,visible:i,moreRunsAvailable:s,moreAvailableParamsAndMetricsColumnCount:o=0}=e;const l=(0,n.useRef)(null),c=(0,n.useRef)(),d=(0,n.useRef)(Boolean(s));(0,n.useEffect)((()=>{d.current=Boolean(s)}),[s]);const u=(0,n.useCallback)((e=>{if(!l.current||!window.ResizeObserver||!e)return;const t=l.current,r=e.querySelector(Wr),n=e.querySelector($r),a=e.querySelector(zr),i=e.querySelector(Vr),s=e.querySelector(jr);let o=0,u=0,p=0,h=0,m=0,g=0;if(n&&a&&i&&r&&s){const e=new ResizeObserver((e=>{var l,v,f,y;for(const t of e)t.target===r&&(o=t.contentRect.width),t.target===n&&(u=t.contentRect.width,p=t.contentRect.height),t.target===s&&(m=t.contentRect.height),t.target===i&&(g=t.contentRect.height),t.target===a&&(h=t.contentRect.width);const C=u+h,x=g;C+180>=o?null===(l=c.current)||void 0===l||l.classList.add(_r):null===(v=c.current)||void 0===v||v.classList.remove(_r);const b=d.current?32:0,Z=p<m?p-b:m;Z<100?null===(f=c.current)||void 0===f||f.classList.add(Xr):null===(y=c.current)||void 0===y||y.classList.remove(Xr),t.style.transform=`translate3d(${C}px, ${x}px, 0)`,t.style.height=`${Z+1}px`}));return e.observe(n),e.observe(a),e.observe(i),e.observe(r),e.observe(s),()=>e.disconnect()}}),[]);return(0,n.useEffect)((()=>{a&&r&&(c.current=r,u(r))}),[u,a,r]),window.ResizeObserver?(0,h.tZ)("div",{ref:l,css:qr.columnContainer,className:i?"":Kr,children:i&&(0,h.tZ)("div",{css:qr.buttonContainer,children:(0,h.BX)(b.B,{css:qr.button,type:"link",onClick:t,children:[(0,h.tZ)(v.wl8,{css:qr.buttonIcon}),(0,h.tZ)("div",{css:qr.caption,children:(0,h.tZ)(E.Z,{id:"npHb2a",defaultMessage:"Show more columns {count, select, 0 {} other {({count} total)}}",values:{count:o}})})]})})}):null},qr={columnContainer:e=>({width:180,height:0,position:"absolute",border:`1px solid ${e.colors.grey200}`,borderTop:0,top:0,left:0,willChange:"transform",transform:"translate3d(0, 0, 0)",".is-minimized &":{display:"flex",alignItems:"center"},"&.is-hidden, .is-out-of-viewport &":{display:"none"},pointerEvents:"none",display:"flex",alignItems:"center"}),buttonContainer:e=>({top:0,paddingLeft:e.spacing.lg,paddingRight:e.spacing.lg,width:"100%",".is-minimized &":{paddingTop:e.spacing.xs},pointerEvents:"all"}),button:{whiteSpace:"pre-wrap",width:"100%"},buttonIcon:e=>({color:e.colors.textSecondary}),caption:e=>({color:e.colors.textSecondary,".is-minimized &":{display:"none"}})},Gr=e=>(0,h.tZ)("strong",{children:e}),Qr=e=>{let{isLoading:t,allRunsCount:r}=e;return(0,h.BX)("div",{css:Jr.statusBar,children:[(0,h.tZ)(b.T.Text,{size:"sm",color:t?"secondary":void 0,children:(0,h.tZ)(E.Z,{id:"gLj8lU",defaultMessage:"<strong>{length}</strong> matching {length, plural, =0 {runs} =1 {run} other {runs}}",values:{strong:Gr,length:r}})}),t&&(0,h.tZ)(b.S,{size:"small"})]})},Jr={statusBar:e=>({height:28,display:"flex",gap:8,marginTop:-1,position:"relative",alignItems:"center",borderTop:`1px solid ${e.colors.border}`})},en=n.memo((e=>{let{experiments:t,searchFacetsState:r,runsData:a,isLoading:i,moreRunsAvailable:s,updateSearchFacets:o,updateViewState:d,onAddColumnClicked:u,rowsData:p,loadMoreRunsFunc:m}=e;const{isComparingRuns:g}=r,{paramKeyList:v,metricKeyList:f,tagsList:y}=a,[C,x]=(0,n.useState)(),[Z,E]=(0,n.useState)(),R=(0,n.useRef)([]),S=(0,n.useMemo)((()=>l.Z.getVisibleTagKeyList(y)),[y]),k=(0,n.useRef)(null),w=(0,n.useMemo)((()=>p.some((e=>{var t;return null===(t=e.runDateAndNestInfo)||void 0===t?void 0:t.hasExpander}))),[p]),M=(0,n.useCallback)((e=>{let{api:t}=e;const r=t.getSelectedRows().filter((e=>!e.isLoadMoreRow)).map((e=>{let{runInfo:t}=e;return t.run_uuid}));d({runsSelected:r.reduce(((e,t)=>({...e,[t]:!0})),{})}),R.current=r}),[d]),B=(0,n.useCallback)((e=>{const t=e.api.getSelectedRows();if(R.current&&t.length!==R.current.length){const t=Boolean(e.node.isSelected()),{runDateAndNestInfo:r}=e.data;if(!r)return;const{isParent:n,expanderOpen:a,childrenIds:i}=r;if(n&&a&&i){const r=i;e.api.forEachNode((e=>{const{runInfo:n,runDateAndNestInfo:a}=e.data,i=n.run_uuid;r.includes(i)&&(null!==a&&void 0!==a&&a.childrenIds&&r.push(...a.childrenIds),e.setSelected(t,!1,!0))}))}}}),[]),T=(0,n.useCallback)(((e,t)=>{o({orderByKey:e,orderByAsc:t})}),[o]),I=(0,n.useCallback)((e=>o((t=>{let{runsExpanded:r,...n}=t;return{...n,runsExpanded:{...r,[e]:!r[e]}}}))),[o]),L=(0,n.useCallback)((e=>{o((t=>({...t,runsPinned:t.runsPinned.includes(e)?t.runsPinned.filter((t=>t!==e)):[...t.runsPinned,e]}))),requestAnimationFrame((()=>{if(!C)return;const t=C.getRowNode(e);t&&C.redrawRows({rowNodes:[t]})}))}),[C,o]),A=(0,n.useCallback)((e=>{o((t=>{if(e===Te.SHOWALL)return{...t,runsHidden:[]};if(e===Te.HIDEALL)return{...t,runsHidden:p.map((e=>e.runUuid))};const r=e;return{...t,runsHidden:t.runsHidden.includes(r)?t.runsHidden.filter((e=>e!==r)):[...t.runsHidden,r]}}))}),[o,p]),D=(0,n.useCallback)((e=>{x(e.api),E(e.columnApi)}),[]),N=Je({searchFacetsState:r,onSortBy:T,onExpand:I,compareExperiments:t.length>1,onTogglePin:L,onToggleVisibility:A,metricKeyList:f,paramKeyList:v,tagKeyList:S,columnApi:Z,isComparingRuns:g});(0,n.useEffect)((()=>{if(C)if(i)C.showLoadingOverlay();else{if(C.hideOverlay(),p.length&&s)return void C.setRowData([...p,{runUuid:(0,c.uniqueId)("load_more"),isLoadMoreRow:!0}]);C.setRowData(p)}}),[C,p,i,s,m]);const O=(0,n.useMemo)((()=>(t.length>1?Qe.length:Ge.length)+(f.length+v.length+S.length)),[t.length,S.length,f.length,v.length]),P=r.selectedColumns.length>=O,U=(0,n.useMemo)((()=>{const e=r.selectedColumns.filter((e=>Xe(e,G.D5.METRICS)||Xe(e,G.D5.PARAMS))).length,t=f.length+v.length;return Math.max(0,t-e)}),[f.length,v.length,r.selectedColumns]),H=!P&&!g&&p.length>0,F=(0,n.useMemo)((()=>a.runInfos.filter((e=>r.runsPinned.includes(e.run_uuid)||a.runUuidsMatchingFilter.includes(e.run_uuid))).length),[a,r.runsPinned]);return(0,n.useLayoutEffect)((()=>{C&&g&&(C.deselectAll(),C.sizeColumnsToFit())}),[C,g]),(0,h.BX)("div",{css:tn.tableAreaWrapper,children:[(0,h.BX)("div",{ref:k,className:Wt()("ag-theme-balham ag-grid-sticky",{"ag-grid-expanders-visible":w}),css:tn.agGridOverrides,children:[(0,h.tZ)(Ur,{defaultColDef:et,columnDefs:N,rowSelection:"multiple",onGridReady:D,onSelectionChanged:M,rowHeight:32,headerHeight:32,onRowSelected:B,suppressRowClickSelection:!0,suppressColumnMoveAnimation:!0,suppressScrollOnNewData:!0,isFullWidthRow:qe,fullWidthCellRenderer:"LoadMoreRowRenderer",fullWidthCellRendererParams:{loadMoreRunsFunc:m},suppressFieldDotNotation:!0,enableCellTextSelection:!0,components:{agColumnHeader:Q,loadingOverlayComponent:b.S,LoadMoreRowRenderer:Fe,SourceCellRenderer:ge,ModelsCellRenderer:he,VersionCellRenderer:ve,DateCellRenderer:ne,ExperimentNameCellRenderer:oe,RowActionsCellRenderer:Ae,RowActionsHeaderCellRenderer:Ne,RunNameCellRenderer:Pe},suppressNoRowsOverlay:!0,loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:{showImmediately:!0},getRowId:Ye,rowBuffer:101}),H&&(0,h.tZ)(Yr,{gridContainerElement:k.current,isInitialized:Boolean(C),onClick:u,visible:!i,moreRunsAvailable:s,moreAvailableParamsAndMetricsColumnCount:U})]}),p.length<1&&!i&&(0,h.tZ)(Hr,{onClearFilters:()=>o(bt),isFiltered:Zt(r)}),(0,h.tZ)(Qr,{allRunsCount:F,isLoading:i})]})})),tn={tableAreaWrapper:{display:"flex",flexDirection:"column"},agGridOverrides:e=>{const t=(e=>({rowBackground:e.colors.backgroundPrimary,rowBackgroundHover:`${e.colors.grey600}0A`,rowBackgroundSelected:`${e.colors.grey600}14`,rowBackgroundHoverSelected:`${e.colors.grey600}1F`,columnSortedBy:`${e.colors.blue100}b3`,headerBackground:e.colors.grey100,headerTextColor:"#2E3840",headerGroupTextColor:e.colors.textSecondary,borderColor:e.colors.grey200,headerBorderColor:"transparent",checkboxBorderColor:e.colors.actionDefaultBorderDefault,checkboxBorderColorChecked:e.colors.backgroundPrimary,checkboxBackgroundColorChecked:e.colors.actionPrimaryBackgroundDefault}))(e);return{height:"100%",position:"relative","&.ag-theme-balham":{"--ag-border-color":t.borderColor,"--ag-row-border-color":t.borderColor,"--ag-odd-row-background-color":t.rowBackground,"--ag-row-hover-color":t.rowBackgroundHover,"--ag-selected-row-background-color":t.rowBackgroundSelected,"--ag-header-foreground-color":t.headerTextColor,"--ag-header-background-color":t.headerBackground,"&.ag-grid-sticky .ag-header":{position:"sticky",top:0,zIndex:1},"&.ag-grid-sticky .ag-root":{overflow:"visible"},"&.ag-grid-sticky .ag-root-wrapper":{border:"0",borderRadius:"4px",overflow:"visible"},".ag-header::after":{content:'""',position:"absolute",top:32,left:0,right:0,height:1,backgroundColor:t.borderColor},".ag-cell":{lineHeight:"min(var(--ag-line-height, 30px), 30px)"},".ag-header-cell":{padding:0},".ag-header-cell .ag-checkbox":{padding:"0 7px",borderLeft:"1px solid transparent"},".ag-cell.is-ordered-by, .ag-header-cell > .is-ordered-by":{backgroundColor:t.columnSortedBy},".ag-header-row":{"--ag-border-color":t.headerBorderColor},".ag-header-row.ag-header-row-column-group":{"--ag-header-foreground-color":t.headerGroupTextColor},".ag-row.ag-row-selected.ag-row-hover":{backgroundColor:t.rowBackgroundHoverSelected},".ag-header:not(:hover) .ag-header-cell::after, .ag-header:not(:hover) .ag-header-group-cell::after":{opacity:0},".ag-pinned-left-header":{borderRight:"none"},".ag-overlay-loading-wrapper":{paddingTop:4*e.spacing.md,alignItems:"center",zIndex:2},".ag-overlay-loading-wrapper .ag-react-container":{flex:1},".ag-center-cols-container":{minHeight:0},".ag-full-width-row":{borderBottom:0,backgroundColor:"transparent",zIndex:1,"&.ag-row-hover":{backgroundColor:"transparent"}},".is-checkbox-cell":{display:"flex",alignItems:"center",paddingLeft:7},".ag-header-cell .ag-checkbox .ag-input-wrapper:not(.ag-indeterminate):not(.ag-checked)":{"--ag-checkbox-background-color":t.headerBackground},".ag-cell-wrapper .ag-selection-checkbox":{marginRight:20},".is-checkbox-cell, .ag-header-cell .ag-checkbox":{".ag-checkbox-input-wrapper::after":{color:t.checkboxBorderColor},".ag-checkbox-input-wrapper.ag-checked":{"--ag-checkbox-background-color":t.checkboxBackgroundColorChecked,"--ag-checkbox-checked-color":t.checkboxBorderColorChecked,"&::after":{color:t.checkboxBorderColorChecked}}}}}}};var rn=r(88673);class nn{constructor(){this.runsSelected={},this.hiddenChildRunsSelected={},this.columnSelectorVisible=!1}}const an=e=>e.map(((e,t)=>{var r;let{runInfo:n,metrics:a=[],params:i=[],tags:s={}}=e;return{index:t,runInfo:n,level:0,isPinnable:!(null!==(r=s["mlflow.parentRunId"])&&void 0!==r&&r.value),metrics:a,params:i,tags:s}})),sn=(e,t,r)=>{if(!e)return[];const n={};for(const a of t)n[`${r}-${a}`]="-";for(const{key:a,value:i}of e)(i||(0,c.isNumber)(i))&&(n[`${r}-${a}`]=i);return n},on=e=>{const t=["#077A9D","#8BCAE7","#FFAB00","#FFDB96","#00A972","#99DDB4","#BA7B23","#FF3621","#FCA4A1","#919191","#00875C","#1B5162","#914B9F","#D01F0B","#BD89C7","#AB4057","#5F5F5F","#BF7080","#C2C2C2","#7F1035"];let r=0,n=0;for(let a=0;a<e.length;a++)r=(r+e.charCodeAt(a))%255,n=(n+r)%255;return t[(r|n<<8)%t.length]},ln=e=>{let{experiments:t,modelVersionsByRunUuid:r,runsExpanded:n,nestChildren:a,referenceTime:i,paramKeyList:s,metricKeyList:o,tagKeyList:c,runsPinned:d,runsHidden:u,runData:p,runUuidsMatchingFilter:h}=e;const m=l.Z.getExperimentNameMap(l.Z.sortExperimentsById(t)),g=a?(e=>{let{runsExpanded:t,runData:r}=e;const n={};r.forEach(((e,t)=>{let{runInfo:r}=e;n[r.run_uuid]=t}));const a=r.map((e=>{let{runInfo:t}=e;return{value:t.run_uuid}}));let i=!1;if(r.forEach(((e,t)=>{let{tags:r}=e;const s=null===r||void 0===r?void 0:r["mlflow.parentRunId"];if(s){const e=n[s.value];void 0!==e&&(i=!0,a[t].parent=a[e])}})),!i)return an(r);const s={},o=[];a.forEach(((e,t)=>{const{parent:r}=e;void 0!==r&&r.value!==e.value?s[r.value]?s[r.value].push(t):s[r.value]=[t]:o.push(t)}));const l=[],c=new Set,d=(e,n)=>{if(!c.has(e)){const a=r[e].runInfo,i=a.run_uuid,u=Boolean(o.includes(e))||0===n,p={index:e,isParent:!1,hasExpander:!1,level:n,runInfo:a,params:r[e].params||[],metrics:r[e].metrics||[],tags:r[e].tags||{},isPinnable:u};s[i]&&(p.isParent=!0,p.hasExpander=!0,p.expanderOpen=Boolean(t[i]),p.childrenIds=s[i].map((e=>r[e].runInfo.run_uuid))),l.push(p),c.add(e);const h=s[i];h&&t[i]&&h.forEach((e=>{d(e,n+1)}))}};return o.forEach((e=>{d(e,0)})),l})({runData:p,runsExpanded:n}):an(p),v=[],f=g.map((e=>{const{runInfo:t,isParent:n=!1,hasExpander:a=!1,level:p=0,expanderOpen:h=!1,isPinnable:g=!1,childrenIds:f=[],tags:y,params:C,metrics:x}=e,b=(x||[]).map((e=>{let{key:t,value:r}=e;return{key:t,value:l.Z.formatMetric(r)}})),Z=t.run_uuid,{experiment_id:E}=t,R=m[E],S=l.Z.getUser(t,y),k=l.Z.getDuration(t.start_time,t.end_time),w=l.Z.getRunName(t)||t.run_uuid,M=l.Z.getVisibleTagValues(y).map((e=>{let[t,r]=e;return{key:t,value:r}})),B={startTime:t.start_time,referenceTime:i,experimentId:E,runUuid:Z,runStatus:t.status,isParent:n,hasExpander:a,expanderOpen:h,childrenIds:f,level:p},T={registeredModels:r[t.run_uuid]||[],loggedModels:l.Z.getLoggedModelsFromTags(y),experimentId:t.experiment_id,runUuid:t.run_uuid},I={version:l.Z.getSourceVersion(y),name:l.Z.getSourceName(y),type:l.Z.getSourceType(y)},L=u.includes(Z),A=g&&d.includes(Z),D=v.includes(Z);return(A||D)&&v.push(...f),{runUuid:Z,runDateAndNestInfo:B,runInfo:t,experimentName:R,experimentId:E,duration:k,user:S,runName:w,tags:y,models:T,version:I,pinnable:g,color:on(Z),hidden:L,pinned:A||D,...sn(C,s,we),...sn(b,o,Me),...sn(M,c,Be)}}));return[...f.filter((e=>{let{pinned:t}=e;return t})),...f.filter((e=>{let{pinned:t,runUuid:r}=e;return!t&&h.includes(r)}))]};var cn=r(42218);let dn;!function(e){e.BAR="BAR",e.LINE="LINE",e.SCATTER="SCATTER",e.CONTOUR="CONTOUR",e.PARALLEL="PARALLEL"}(dn||(dn={}));class un{constructor(e){this.uuid=void 0,this.type=dn.BAR,this.runsCountToCompare=10,this.uuid=e}static serialize(e){return Object.keys(e).reduce(((t,r)=>({...t,[r]:e[r]})),{})}static getEmptyChartCardByType(e,t){return e===dn.BAR?new mn(t):e===dn.SCATTER?new pn(t):e===dn.PARALLEL?new vn(t):e===dn.LINE?new hn(t):new gn(t)}static getBaseChartConfigs(e){const t=[un.getEmptyChartCardByType(dn.PARALLEL,(0,cn.Fs)())];return e&&t.push({...un.getEmptyChartCardByType(dn.BAR,(0,cn.Fs)()),metricKey:e}),t}}class pn extends un{constructor(){super(...arguments),this.type=dn.SCATTER,this.xaxis={key:"",type:"METRIC"},this.yaxis={key:"",type:"METRIC"},this.runsCountToCompare=100}}class hn extends un{constructor(){super(...arguments),this.type=dn.LINE,this.metricKey="",this.scaleType="linear",this.xAxisKey="step"}}class mn extends un{constructor(){super(...arguments),this.type=dn.BAR,this.metricKey=""}}class gn extends un{constructor(){super(...arguments),this.type=dn.CONTOUR,this.xaxis={key:"",type:"METRIC"},this.yaxis={key:"",type:"METRIC"},this.zaxis={key:"",type:"METRIC"}}}class vn extends un{constructor(){super(...arguments),this.type=dn.PARALLEL,this.selectedParams=[],this.selectedMetrics=[]}}var fn,yn,Cn,xn,bn;function Zn(){return Zn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zn.apply(this,arguments)}function En(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",Zn({width:18,height:16,viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,fn||(fn=n.createElement("path",{d:"M1 0.813599V15.1865H17",stroke:"#A3AEB8",strokeLinecap:"round"})),yn||(yn=n.createElement("rect",{x:3.16943,y:10.5763,width:2.16949,height:3.25424,fill:"#338ECC"})),Cn||(Cn=n.createElement("rect",{x:6.42371,y:5.15259,width:2.16949,height:8.67797,fill:"#338ECC"})),xn||(xn=n.createElement("rect",{x:9.67798,y:8.40686,width:2.16949,height:5.42373,fill:"#338ECC"})),bn||(bn=n.createElement("rect",{x:12.9323,y:1.89832,width:2.16949,height:11.9322,fill:"#338ECC"})))}const Rn=n.forwardRef(En);var Sn,kn,wn;r.p;function Mn(){return Mn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mn.apply(this,arguments)}function Bn(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",Mn({width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,Sn||(Sn=n.createElement("path",{d:"M1 1V17H17",stroke:"#A3AEB8",strokeLinecap:"round"})),kn||(kn=n.createElement("path",{d:"M12.9749 4.94148C12.9188 4.71702 12.221 4.73284 12.0618 4.71515C11.1779 4.61693 10.2817 4.66052 9.39271 4.66052C8.11919 4.66052 7.15648 4.97961 6.24753 5.90922C5.86197 6.30355 5.5235 6.77684 5.23295 7.24378C4.99434 7.62726 4.65544 7.93479 4.40569 8.31299C3.93777 9.02154 3.56281 9.80723 3.56281 10.6699C3.56281 11.1806 3.37479 11.598 3.76962 12.0669C4.19449 12.5714 4.6863 12.9507 5.27978 13.2649C5.88594 13.5858 6.42202 13.8619 7.13723 13.8619C7.74338 13.8619 8.34952 13.8619 8.95567 13.8619C9.45735 13.8619 9.96042 13.8731 10.4619 13.8619C11.1412 13.8468 11.9484 13.1895 12.413 12.7381C13.581 11.6035 14.2393 9.88016 14.2393 8.24665C14.2393 7.69923 14.3797 7.17063 14.3797 6.62723C14.3797 6.40084 14.4779 5.87696 14.2744 5.71411C13.9268 5.43606 13.5785 5.13789 13.1857 4.94148",stroke:"#338ECC",strokeLinecap:"round"})),wn||(wn=n.createElement("path",{d:"M11.9213 6.83789C11.2761 6.83789 10.6309 6.83789 9.98577 6.83789C9.19776 6.83789 8.80182 7.44144 8.2844 7.97734C7.58163 8.70521 7.28544 9.67306 7.28544 10.666C7.28544 10.9641 7.22004 11.177 7.46104 11.3645C7.6831 11.5372 8.10719 11.6142 8.37806 11.6142C9.07316 11.6142 9.91042 11.5583 10.4462 11.0523C10.9277 10.5975 11.473 10.3701 11.8159 9.75284C12.045 9.34042 12.2022 8.86324 12.2022 8.38317C12.2022 8.14903 12.2022 7.9149 12.2022 7.68077C12.2022 7.4241 12.0208 7.38817 11.9213 7.18909",stroke:"#338ECC",strokeLinecap:"round"})))}const Tn=n.forwardRef(Bn);var In,Ln;r.p;function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},An.apply(this,arguments)}function Dn(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",An({width:22,height:22,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,In||(In=n.createElement("path",{d:"M4.38977 15.717L8.79655 10.8113L12.5254 14.9622L19.644 7.03772",stroke:"#338ECC",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),Ln||(Ln=n.createElement("path",{d:"M1 1V21H21",stroke:"#A3AEB8",strokeLinecap:"round"})))}const Nn=n.forwardRef(Dn);var On,Pn,Un,Hn,Fn;r.p;function _n(){return _n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_n.apply(this,arguments)}function Kn(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",_n({width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,On||(On=n.createElement("path",{d:"M1 1V17H17",stroke:"#A3AEB8",strokeLinecap:"round"})),Pn||(Pn=n.createElement("path",{d:"M4.21875 3.58289C4.55663 3.58289 4.88067 3.68935 5.21469 3.73008C5.6474 3.78285 6.02137 3.96513 6.37191 4.21552C6.76902 4.49917 7.0271 4.74589 7.24101 5.18954C7.44337 5.60925 7.59378 6.06989 7.72958 6.51432C7.86002 6.94121 8.09708 7.33726 8.19153 7.77803C8.25347 8.0671 8.34514 8.32427 8.44678 8.60015C8.58028 8.96252 8.80086 9.27915 8.96667 9.62583C9.15145 10.0122 9.216 10.4461 9.34876 10.8551C9.57831 11.5623 9.91132 12.4763 10.7205 12.6731C11.4284 12.8453 12.1459 12.8845 12.8705 12.8845C13.0981 12.8845 13.3979 12.898 13.5831 12.7499C13.6402 12.7042 13.7451 12.6907 13.8164 12.6591C13.8752 12.6329 14.0919 12.5871 14.1123 12.5463",stroke:"#CCE3F2",strokeLinecap:"round"})),Un||(Un=n.createElement("path",{d:"M4.16162 12.9805C4.32512 12.9805 4.4895 12.9859 4.65284 12.9805C4.84076 12.9742 5.0468 12.7952 5.2099 12.707C5.62236 12.4841 5.99426 12.0648 6.24299 11.6739C6.49491 11.2781 6.8776 10.9871 7.0887 10.5649C7.27767 10.187 7.50992 9.80749 7.73691 9.45078C7.93911 9.13304 8.10211 8.77722 8.28637 8.44554C8.43088 8.18544 8.45 7.88672 8.60542 7.62768C8.94898 7.05509 9.16215 6.418 9.45873 5.82484C9.72614 5.29001 9.96898 4.82426 10.4159 4.42207C10.5753 4.27853 10.8984 4.21824 11.0995 4.14861C11.3303 4.06873 11.579 4.02714 11.8136 3.93592C12.0394 3.84807 12.2521 3.84383 12.4795 3.77386C12.6993 3.70623 12.9319 3.63713 13.1632 3.63713C13.5192 3.63713 13.9089 3.59155 14.2798 3.59155",stroke:"#CCE3F2",strokeLinecap:"round"})),Hn||(Hn=n.createElement("path",{d:"M3.79248 2.74207V13.8225",stroke:"#338ECC",strokeLinecap:"round"})),Fn||(Fn=n.createElement("path",{d:"M14.873 3.04419V13.7217",stroke:"#338ECC",strokeLinecap:"round"})))}const Xn=n.forwardRef(Kn);var Wn,$n,zn,Vn,jn,Yn,qn;r.p;function Gn(){return Gn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gn.apply(this,arguments)}function Qn(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",Gn({width:18,height:16,viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,Wn||(Wn=n.createElement("path",{d:"M1 0.813599V15.1865H17",stroke:"#A3AEB8",strokeLinecap:"round"})),$n||($n=n.createElement("circle",{cx:3.98301,cy:12.4746,r:1.35593,fill:"#338ECC"})),zn||(zn=n.createElement("ellipse",{cx:9.40684,cy:10.8475,rx:1.35593,ry:1.35593,fill:"#338ECC"})),Vn||(Vn=n.createElement("circle",{cx:5.6102,cy:8.1356,r:1.35593,fill:"#338ECC",fillOpacity:.25})),jn||(jn=n.createElement("circle",{cx:9.40684,cy:6.50852,r:1.35593,fill:"#338ECC"})),Yn||(Yn=n.createElement("ellipse",{cx:13.7457,cy:5.96616,rx:1.35593,ry:1.35593,fill:"#338ECC",fillOpacity:.25})),qn||(qn=n.createElement("ellipse",{cx:16.4576,cy:2.46128,rx:1.35593,ry:1.35593,fill:"#338ECC"})))}const Jn=n.forwardRef(Qn);r.p;const ea=e=>{let{onAddChart:t}=e;return(0,h.BX)(v.h_2.Root,{modal:!1,children:[(0,h.tZ)(v.h_2.Trigger,{asChild:!0,children:(0,h.tZ)(b.B,{css:ta.addChartButton,icon:(0,h.tZ)(v.pOD,{}),"data-testid":"experiment-view-compare-runs-add-chart",children:"Add chart"})}),(0,h.BX)(v.h_2.Content,{align:"end",children:[(0,h.BX)(v.h_2.Item,{onClick:()=>t(dn.BAR),"data-testid":"experiment-view-compare-runs-chart-type-bar",children:[(0,h.tZ)(v.h_2.IconWrapper,{css:ta.iconWrapper,children:(0,h.tZ)(Rn,{})}),"Bar chart"]}),(0,h.BX)(v.h_2.Item,{onClick:()=>t(dn.LINE),"data-testid":"experiment-view-compare-runs-chart-type-line",children:[(0,h.tZ)(v.h_2.IconWrapper,{css:ta.iconWrapper,children:(0,h.tZ)(Nn,{})}),"Line chart"]}),(0,h.BX)(v.h_2.Item,{onClick:()=>t(dn.PARALLEL),"data-testid":"experiment-view-compare-runs-chart-type-parallel",children:[(0,h.tZ)(v.h_2.IconWrapper,{css:ta.iconWrapper,children:(0,h.tZ)(Xn,{})}),"Parallel coordinates"]}),(0,h.BX)(v.h_2.Item,{onClick:()=>t(dn.SCATTER),"data-testid":"experiment-view-compare-runs-chart-type-scatter",children:[(0,h.tZ)(v.h_2.IconWrapper,{css:ta.iconWrapper,children:(0,h.tZ)(Jn,{})}),"Scatter chart"]}),(0,h.BX)(v.h_2.Item,{onClick:()=>t(dn.CONTOUR),"data-testid":"experiment-view-compare-runs-chart-type-contour",children:[(0,h.tZ)(v.h_2.IconWrapper,{css:ta.iconWrapper,children:(0,h.tZ)(Tn,{})}),"Contour chart"]})]})]})},ta={addChartButton:e=>({backgroundColor:`${e.colors.backgroundPrimary} !important`}),iconWrapper:e=>({width:e.general.iconSize+e.spacing.xs})};var ra=r(61231);const na=e=>{const t=(0,n.useRef)(e);return(0,n.useEffect)((()=>{t.current=e}),[e]),e=>{t.current(e)}},aa=(e,t)=>(r,n,a)=>{var i,s;const o=-1===n&&-1===a;var l,c,d,u;(null===(i=r.querySelector(".is-hover-highlight"))||void 0===i||i.classList.remove("is-hover-highlight"),n>-1)&&(null===(l=r.querySelectorAll(e)[n])||void 0===l||l.classList.add("is-hover-highlight"));(null===(s=r.querySelector(".is-selection-highlight"))||void 0===s||s.classList.remove("is-selection-highlight"),a>-1)&&(null===(c=r.querySelectorAll(e)[a])||void 0===c||c.classList.add("is-selection-highlight"));o?null===(d=r.querySelector(t))||void 0===d||d.classList.remove("is-highlight"):null===(u=r.querySelector(t))||void 0===u||u.classList.add("is-highlight")},ia=aa("svg .trace.bars g.point",".trace.bars"),sa=aa("svg .scatterlayer g.trace",".scatterlayer"),oa=aa("svg .scatterlayer path.point",".trace.scatter"),la=(e,t,r,a)=>{const i=(0,n.useMemo)((()=>e?r.findIndex((e=>e.runInfo.run_uuid===t)):-1),[r,e,t]),[s,o]=(0,n.useState)(-1);return(0,n.useEffect)((()=>{e&&a(e,s,i)}),[a,e,i,s]),{selectedTraceIndex:i,hoveredPointIndex:s,setHoveredPointIndex:o}};var ca=r(43339);const da={displaylogo:!1,scrollZoom:!0,doubleClick:"autosize",showTips:!1},ua=n.memo((e=>{let{runsData:t,metricKey:r,className:a,margin:i=ca.MP,onUpdate:o,onHover:l,onUnhover:c,barWidth:d=.5,width:u,height:p,displayRunNames:m=!0,useDefaultHoverBox:g=!0,displayMetricKey:v=!0,selectedRunUuid:f}=e;const y=(0,n.useMemo)((()=>{const e=t.map((e=>e.runInfo.run_uuid)),n=t.map((e=>{var t;return(0,ca.To)(null===(t=e.metrics[r])||void 0===t?void 0:t.value)})),a=t.map((e=>{var t;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof e?e.toFixed(t):e}(null===(t=e.metrics[r])||void 0===t?void 0:t.value)})),i=t.map((e=>e.color)),s=n.some((e=>e&&e<0));return[{y:e,x:n,text:a,textposition:s?"auto":"outside",textfont:{size:11},type:"bar",hovertemplate:g?"%{label}<extra></extra>":void 0,hoverinfo:g?"y":"none",hoverlabel:g?ca.Lg:void 0,width:d,orientation:"h",marker:{color:i}}]}),[t,r,d,g]),{layoutHeight:C,layoutWidth:x,setContainerDiv:b,containerDiv:Z,isDynamicSizeSupported:E}=(0,ca.Ih)(),{formatMessage:R}=s(),[S,k]=(0,n.useState)({width:u||x,height:p||C,margin:i,xaxis:{title:v?r:void 0},yaxis:{showticklabels:m,title:m?R({id:"+hQ+de",defaultMessage:"Run name"}):void 0,tickfont:{size:11},fixedrange:!0}});(0,n.useEffect)((()=>{k((e=>({...e,width:u||x,height:p||C,margin:i,xaxis:{...e.xaxis,title:v?r:void 0}})))}),[x,C,i,r,u,p,v]);const{setHoveredPointIndex:w}=la(Z,f,t,ia),M=(0,n.useCallback)((e=>{var t,r,n;let{points:a,event:i}=e;w(null!==(t=null===(r=a[0])||void 0===r?void 0:r.pointIndex)&&void 0!==t?t:-1);const s=null===(n=a[0])||void 0===n?void 0:n.label;s&&(null===l||void 0===l||l(s,i))}),[l,w]),B=(0,n.useCallback)((()=>{null===c||void 0===c||c(),w(-1)}),[c,w]),T=na(M);return(0,h.tZ)("div",{css:[ca.QW.chartWrapper,pa.highlightStyles,""],className:a,ref:b,children:(0,h.tZ)(ra.L,{data:y,useResizeHandler:!E,css:ca.QW.chart,onUpdate:o,layout:S,config:da,onHover:T,onUnhover:B})})})),pa={highlightStyles:{".trace.bars g.point path":{transition:"var(--trace-transition)"},".trace.bars.is-highlight g.point path":{opacity:"var(--trace-opacity-dimmed-high) !important"},".trace.bars g.point.is-hover-highlight path":{opacity:"var(--trace-opacity-highlighted) !important"},".trace.bars g.point.is-selection-highlight path":{opacity:"var(--trace-opacity-highlighted) !important",stroke:"var(--trace-stroke-color)",strokeWidth:"var(--trace-stroke-width) !important"}}},ha=n.createContext(null);let ma;!function(e){e[e.HIDDEN=0]="HIDDEN",e[e.HOVER=1]="HOVER",e[e.VISIBLE=2]="VISIBLE"}(ma||(ma={}));const ga=e=>{if(null===e||!(e instanceof Element))return null;if(e instanceof HTMLElement)return e;let t=e;for(;t&&!(t instanceof HTMLElement);)t=t.parentElement;return t},va=e=>{let{className:t,children:r,contextData:a,component:i,hoverOnly:s=!1}=e;const o=(0,n.useRef)(null),l=(0,n.useRef)(null),c=(0,n.useRef)({x:0,y:0}),[d,u]=(0,n.useState)(ma.HIDDEN),[p,m]=(0,n.useState)(null),[g,v]=(0,n.useState)(""),[f,y]=(0,n.useState)(null),C=(0,n.useRef)(null),x=(0,n.useRef)(d),b=(0,n.useRef)(g),Z=(0,n.useRef)(p),E=(0,n.useCallback)((()=>{if(!l.current||!o.current)return;let e=c.current.x,t=c.current.y;const r=l.current.getBoundingClientRect(),n=o.current.getBoundingClientRect();c.current.x+r.width>=n.width&&(e-=r.width),c.current.y+r.height>=n.height&&(t-=r.height),l.current.style.left="0px",l.current.style.top="0px",l.current.style.transform=`translate3d(${e+1}px, ${t+1}px, 0)`}),[]);(0,n.useEffect)((()=>{x.current=d}),[d]);const R=(0,n.useCallback)(((e,t)=>{var r;const n=e.getBoundingClientRect(),a=(null===(r=o.current)||void 0===r?void 0:r.getBoundingClientRect())||{left:0,top:0};return{x:t.offsetX+(n.left-a.left),y:t.offsetY+(n.top-a.top)}}),[]),S=(0,n.useCallback)((e=>{if(x.current===ma.HOVER&&l.current&&o.current){C.current=null;const t=ga(e.target);t&&(c.current=R(t,e.nativeEvent),E())}}),[E,R]),k=(0,n.useCallback)(((e,t,r,n)=>{var a;b.current=e,Z.current=t,x.current!==ma.VISIBLE&&(m(t),!e&&null!==(a=C.current)&&void 0!==a&&a.runUuid||v((t=>(n&&y(n),x.current===ma.HIDDEN||x.current===ma.HOVER&&e!==t?(u(ma.HOVER),e):t))))}),[]),w=(0,n.useCallback)((e=>{s||0===e.button&&b.current&&(C.current={x:e.nativeEvent.pageX,y:e.nativeEvent.pageY,runUuid:b.current})}),[s]),M=(0,n.useCallback)((e=>{var t;if(null!==(t=C.current)&&void 0!==t&&t.runUuid&&e.nativeEvent.pageX===C.current.x&&e.nativeEvent.pageY===C.current.y){if(x.current===ma.VISIBLE){v(C.current.runUuid);const t=ga(e.nativeEvent.target);t&&(c.current=R(t,e.nativeEvent),E())}else u(ma.VISIBLE);e.stopPropagation()}C.current=null}),[E,R]),B=(0,n.useCallback)((()=>u(ma.HIDDEN)),[]);(0,n.useLayoutEffect)((()=>{if(!o.current)return;const e=o.current.getRootNode(),t=e=>{var t;if(x.current!==ma.VISIBLE)return;const r=ga(e.target);if(!r)return;r instanceof HTMLElement&&(null===l||void 0===l?void 0:l.current)instanceof HTMLElement&&l.current.contains(r)||null!==(t=C.current)&&void 0!==t&&t.runUuid||u(ma.HIDDEN)};return e.addEventListener("click",t,{capture:!0}),()=>{e.removeEventListener("click",t,{capture:!0})}}),[R,E]);const T=(0,n.useCallback)((()=>{var e;b.current="",null!==(e=C.current)&&void 0!==e&&e.runUuid||x.current===ma.VISIBLE||(v(""),u(ma.HIDDEN))}),[]),I=(0,n.useMemo)((()=>d!==ma.VISIBLE?null:g),[d,g]),L=(0,n.useMemo)((()=>({updateTooltip:k,resetTooltip:T,selectedRunUuid:I,closeContextMenu:B})),[k,T,I,B]);return(0,h.BX)(ha.Provider,{value:L,children:[(0,h.tZ)("div",{onMouseMove:S,onMouseDownCapture:w,onClickCapture:M,children:r}),(0,h.tZ)("div",{css:ya.contextMenuContainer,className:t,ref:o,children:d!==ma.HIDDEN&&g&&(0,h.tZ)("div",{ref:l,css:ya.contextMenuWrapper,"data-testid":"tooltip-container",style:{userSelect:d===ma.HOVER?"none":"unset",pointerEvents:d===ma.HOVER?"none":"all"},children:(0,h.tZ)(i,{runUuid:g,additionalAxisData:f,hoverData:p,contextData:a,isHovering:d===ma.HOVER,closeContextMenu:B})})})]})},fa=e=>{const t=(0,n.useContext)(ha);if(!t)throw new Error("You must invoke useCompareRunsTooltip() in a component being ancestor of <CompareRunsTooltipWrapper />!");const{updateTooltip:r,resetTooltip:a,selectedRunUuid:i,closeContextMenu:s}=t,o=(0,n.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;r(t,e,n,a)}),[r,e]);return{setTooltip:o,resetTooltip:a,selectedRunUuid:i,closeContextMenu:s}},ya={contextMenuContainer:{overflow:"hidden",top:0,left:0,width:"100%",height:"100%",position:"fixed",pointerEvents:"none"},contextMenuWrapper:e=>({zIndex:1,position:"absolute",padding:e.spacing.sm,backgroundColor:"white",border:`1px solid ${e.colors.border}`,left:-999,top:-999}),overlayElement:()=>({"&::after":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"transparent"}})};var Ca={name:"1ykowef",styles:"margin-bottom:0"};const xa=e=>{let{title:t,subtitle:r,onDelete:n,onEdit:a,children:i,fullWidth:s=!1}=e;return(0,h.BX)("div",{css:ba.chartEntry(s),"data-testid":"experiment-view-compare-runs-card",children:[(0,h.BX)("div",{css:ba.chartEntryTitle,children:[(0,h.BX)("div",{children:[(0,h.tZ)(b.T.Title,{level:4,css:Ca,children:t}),r&&(0,h.tZ)("span",{css:ba.subtitle,children:r})]}),(0,h.BX)(v.h_2.Root,{modal:!1,children:[(0,h.tZ)(v.h_2.Trigger,{asChild:!0,children:(0,h.tZ)(b.B,{type:"tertiary",icon:(0,h.tZ)(v.VZO,{}),"data-testid":"experiment-view-compare-runs-card-menu"})}),(0,h.BX)(v.h_2.Content,{align:"end",minWidth:100,children:[(0,h.tZ)(v.h_2.Item,{onClick:a,"data-testid":"experiment-view-compare-runs-card-edit",children:"Configure"}),(0,h.tZ)(v.h_2.Item,{onClick:n,"data-testid":"experiment-view-compare-runs-card-delete",children:"Delete"})]})]})]}),i]})},ba={chartEntry:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t=>({height:360,maxWidth:e?"unset":800,overflow:"hidden",display:"grid",gridTemplateRows:"auto 1fr",backgroundColor:t.colors.backgroundPrimary,padding:t.spacing.md,border:`1px solid ${t.colors.border}`,borderRadius:t.general.borderRadiusBase})},chartComponentWrapper:()=>({overflow:"hidden"}),chartEntryTitle:()=>({display:"grid",gridTemplateColumns:"1fr auto",alignItems:"flex-start"}),subtitle:e=>({color:e.colors.textSecondary,fontSize:11})},Za={t:24,b:48,r:0,l:4,pad:0},Ea=e=>{let{config:t,chartRunData:r,onDelete:a,onEdit:i}=e;const s=(0,n.useMemo)((()=>r.slice(0,t.runsCountToCompare||10).reverse()),[r,t]),{setTooltip:o,resetTooltip:l,selectedRunUuid:c}=fa(t);return(0,h.tZ)(xa,{onEdit:i,onDelete:a,title:t.metricKey,subtitle:(0,h.BX)(h.HY,{children:["Comparing first ",s.length," runs"]}),children:(0,h.tZ)("div",{css:Ra.barChartCardWrapper,children:(0,h.tZ)(ua,{runsData:s,metricKey:t.metricKey,displayRunNames:!1,displayMetricKey:!1,useDefaultHoverBox:!1,margin:Za,onHover:o,onUnhover:l,selectedRunUuid:c})})})},Ra={barChartCardWrapper:{overflow:"hidden"}};var Sa,ka,wa,Ma;function Ba(){return Ba=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ba.apply(this,arguments)}function Ta(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",Ba({width:80,height:42,viewBox:"0 0 80 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,Sa||(Sa=n.createElement("path",{d:"M1.28418 2.34094L39.4998 17.0908L76.3746 7.87216",stroke:"#CF797B",strokeLinecap:"round"})),ka||(ka=n.createElement("path",{d:"M1.95459 20.443L40.1702 25.1361L77.045 21.1134M1.95459 36.5338L40.1702 35.1929L77.045 25.1361",stroke:"#A88E6F",strokeLinecap:"round"})),wa||(wa=n.createElement("g",{opacity:.8},n.createElement("path",{d:"M1.28418 1V40.3341",stroke:"#338ECC",strokeLinecap:"round"}),n.createElement("path",{d:"M40.6189 2.07251V39.9763",stroke:"#338ECC",strokeLinecap:"round"}),n.createElement("path",{d:"M77.7156 2.07251V39.9763",stroke:"url(#paint0_linear_2781_406689)",strokeWidth:4,strokeLinecap:"square"}))),Ma||(Ma=n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_2781_406689",x1:78.2156,y1:2.07251,x2:78.2156,y2:39.9763,gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#D04F5E"}),n.createElement("stop",{offset:1,stopColor:"#4D9734"})))))}const Ia=n.forwardRef(Ta);r.p;const La=n.lazy((()=>Promise.all([r.e(276),r.e(618)]).then(r.bind(r,92971))));function Aa(e,t,r){return e.map((e=>{const n={uuid:e.runInfo.run_uuid};function a(e,t){if(Array.isArray(e))for(const r of e)n[r]=r in t?t[r].value:null}return a(t,e.params),a(r,e.metrics),n}))}var Da=e=>(0,h.tZ)(n.Suspense,{fallback:(0,h.tZ)(v.OdW,{}),children:(0,h.tZ)(La,{...e})});var Na={name:"1neqb0a",styles:"display:flex;flex:1;justify-content:center;align-items:center"},Oa={name:"10zh1lj",styles:"display:flex;flex-direction:column;align-items:center;max-width:360px"},Pa={name:"yz1nei",styles:"margin-top:16px"},Ua={name:"18uqayh",styles:"margin-bottom:16px"};const Ha=e=>{let{onEdit:t}=e;return(0,h.tZ)("div",{css:Na,children:(0,h.BX)("div",{css:Oa,children:[(0,h.tZ)(Ia,{}),(0,h.tZ)(b.T.Title,{css:Pa,color:"secondary",level:3,children:"Compare parameter importance"}),(0,h.tZ)(b.T.Text,{css:Ua,color:"secondary",children:"Use the parallel coordinates chart to compare how various parameters in model affect your model metrics."}),(0,h.tZ)(b.B,{type:"primary",onClick:t,children:"Configure chart"})]})})},Fa=e=>{let{config:t,chartRunData:r,onDelete:a,onEdit:i}=e;const[s,o]=(0,n.useMemo)((()=>{var e,n;const a=((null===(e=t.selectedParams)||void 0===e?void 0:e.length)||0)+((null===(n=t.selectedMetrics)||void 0===n?void 0:n.length)||0)>=2;return[a,a?Aa(r,t.selectedParams,t.selectedMetrics):[]]}),[t,r]),{setTooltip:l,resetTooltip:c,selectedRunUuid:d,closeContextMenu:u}=fa(t);return(0,h.tZ)(xa,{onEdit:i,onDelete:a,title:"Parallel Coordinates",subtitle:s?(0,h.BX)(h.HY,{children:["Comparing ",r.length," runs"]}):null,fullWidth:!0,children:s?o.length?(0,h.tZ)("div",{css:_a.parallelChartCardWrapper,children:(0,h.tZ)(Da,{data:o,selectedParams:t.selectedParams,selectedMetrics:t.selectedMetrics,onHover:l,onUnhover:c,axesRotateThreshold:8,selectedRunUuid:d,closeContextMenu:u})}):null:(0,h.tZ)(Ha,{onEdit:i})})},_a={parallelChartCardWrapper:{display:"flex",overflow:"hidden",cursor:"pointer"}};var Ka=r(51554);const Xa={displaylogo:!1,scrollZoom:!0},Wa=n.memo((e=>{let{runsData:t,xAxis:r,yAxis:a,markerSize:i=10,className:s,margin:o=ca.MP,onUpdate:l,onHover:c,onUnhover:d,width:u,height:p,useDefaultHoverBox:m=!0,selectedRunUuid:g}=e;const v=(0,Ka.u)(),{layoutHeight:f,layoutWidth:y,setContainerDiv:C,containerDiv:x,isDynamicSizeSupported:b}=(0,ca.Ih)(),Z=(0,n.useMemo)((()=>{const e=[],n=[],s=[],o=[];for(const i of t){var l,c;const{runInfo:{run_uuid:t,run_name:d},metrics:u,params:p,color:h}=i,m="METRIC"===r.type?u:p,g="METRIC"===a.type?u:p,f=(null===m||void 0===m||null===(l=m[r.key])||void 0===l?void 0:l.value)||void 0,y=(null===g||void 0===g||null===(c=g[a.key])||void 0===c?void 0:c.value)||void 0;f&&y&&(e.push(f),n.push(y),s.push(h||v.colors.primary),o.push([t,d||t]))}return[{x:e,y:n,customdata:o,hovertemplate:m?"<b>%{customdata[1]}:</b><br><b>%{xaxis.title.text}:</b> %{x:.2f}<br><b>%{yaxis.title.text}:</b> %{y:.2f}<br><extra></extra>":void 0,hoverinfo:m?void 0:"none",hoverlabel:m?ca.Lg:void 0,type:"scatter",mode:"markers",marker:{size:i,color:s}}]}),[t,r,a,v,i,m]),[E,R]=(0,n.useState)({width:u||y,height:p||f,margin:o,xaxis:{title:r.key},yaxis:{title:a.key}});(0,n.useEffect)((()=>{R((e=>{const t={...e,width:u||y,height:p||f,margin:o};return t.xaxis&&(t.xaxis.title=r.key),t.yaxis&&(t.yaxis.title=a.key),t}))}),[y,f,o,r.key,a.key,u,p]);const{setHoveredPointIndex:S}=la(x,g,t,oa),k=(0,n.useCallback)((e=>{var t,r,n,a;let{points:i}=e;const s=null===(t=i[0])||void 0===t||null===(r=t.customdata)||void 0===r?void 0:r[0];S(null!==(n=null===(a=i[0])||void 0===a?void 0:a.pointIndex)&&void 0!==n?n:-1),s&&(null===c||void 0===c||c(s))}),[c,S]),w=(0,n.useCallback)((()=>{null===d||void 0===d||d(),S(-1)}),[d,S]),M=na(k);return(0,h.tZ)("div",{css:[ca.QW.chartWrapper,ca.QW.scatterChartHighlightStyles,""],className:s,ref:C,children:(0,h.tZ)(ra.L,{data:Z,useResizeHandler:!b,css:ca.QW.chart,layout:E,config:Xa,onUpdate:l,onHover:M,onUnhover:w})})})),$a=e=>{let{config:t,chartRunData:r,onDelete:a,onEdit:i}=e;const s=(0,n.useMemo)((()=>r.slice(0,t.runsCountToCompare||10).reverse()),[r,t]),{setTooltip:o,resetTooltip:l,selectedRunUuid:c}=fa(t);return(0,h.tZ)(xa,{onEdit:i,onDelete:a,title:`${t.xaxis.key} vs. ${t.yaxis.key}`,subtitle:(0,h.BX)(h.HY,{children:["Comparing first ",s.length," runs"]}),children:(0,h.tZ)("div",{css:za.scatterChartCardWrapper,children:(0,h.tZ)(Wa,{runsData:s,xAxis:t.xaxis,yAxis:t.yaxis,onHover:o,onUnhover:l,useDefaultHoverBox:!1,selectedRunUuid:c})})})},za={scatterChartCardWrapper:{overflow:"hidden"}},Va={displaylogo:!1,scrollZoom:!0},ja=[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Ya=n.memo((e=>{let{runsData:t,xAxis:r,yAxis:a,zAxis:i,markerSize:s=10,className:o,reverseScale:l,margin:c=ca.r$,colorScale:d=ja,onUpdate:u,onHover:p,onUnhover:m,width:g,height:v,useDefaultHoverBox:f=!0,selectedRunUuid:y}=e;const C=(0,Ka.u)(),{layoutHeight:x,layoutWidth:b,setContainerDiv:Z,containerDiv:E,isDynamicSizeSupported:R}=(0,ca.Ih)(),S=(0,n.useMemo)((()=>{const e=[],n=[],o=[],c=[],u=[];for(const s of t){var p,h,m;const{runInfo:{run_uuid:t,run_name:l},metrics:d,params:g,color:v}=s,f="METRIC"===r.type?d:g,y="METRIC"===a.type?d:g,x="METRIC"===i.type?d:g,b=(null===f||void 0===f||null===(p=f[r.key])||void 0===p?void 0:p.value)||void 0,Z=(null===y||void 0===y||null===(h=y[a.key])||void 0===h?void 0:h.value)||void 0,E=(null===x||void 0===x||null===(m=x[i.key])||void 0===m?void 0:m.value)||void 0;b&&Z&&E&&(e.push(b),n.push(Z),o.push(E),c.push(v||C.colors.primary),u.push([t,l||t,E]))}const g=[{x:e,y:n,customdata:u,hovertemplate:f?(v=i.key,`<b>%{customdata[1]}:</b><br><b>%{xaxis.title.text}:</b> %{x:.2f}<br><b>%{yaxis.title.text}:</b> %{y:.2f}<br><b>${v}:</b> %{customdata[2]:.2f}<extra></extra>`):void 0,hoverinfo:f?void 0:"none",hoverlabel:f?ca.Lg:void 0,type:"scatter",mode:"markers",marker:{size:s,color:c,line:{color:"black",width:1}}}];var v;return t.length>1&&g.unshift({x:e,y:n,z:o,type:"contour",connectgaps:!0,hoverinfo:"none",contours:{coloring:"heatmap"},colorscale:d,reversescale:l}),g}),[d,l,s,t,r.type,r.key,a.type,a.key,i.type,i.key,C.colors.primary,f]),[k,w]=(0,n.useState)({width:g||b,height:v||x,margin:c,xaxis:{title:r.key},yaxis:{ticks:"inside",title:{standoff:32,text:a.key}}});(0,n.useEffect)((()=>{w((e=>{const t={...e,width:g||b,height:v||x,margin:c};return t.xaxis&&(t.xaxis.title=r.key),t.yaxis&&(t.yaxis.title={standoff:32,text:a.key}),t}))}),[b,x,c,r.key,a.key,g,v]);const{setHoveredPointIndex:M}=la(E,y,t,oa),B=(0,n.useCallback)((e=>{var t,r;let{points:n}=e;const a=n.find((e=>{let{curveNumber:t}=e;return 1===t}));if(M(null!==(t=null===a||void 0===a?void 0:a.pointIndex)&&void 0!==t?t:-1),!a)return;const i=null===a||void 0===a||null===(r=a.customdata)||void 0===r?void 0:r[0];i&&(null===p||void 0===p||p(i))}),[p,M]),T=(0,n.useCallback)((()=>{null===m||void 0===m||m(),M(-1)}),[m,M]),I=na(B);return(0,h.tZ)("div",{css:[ca.QW.chartWrapper,ca.QW.scatterChartHighlightStyles,""],className:o,ref:Z,children:(0,h.tZ)(ra.L,{data:S,useResizeHandler:!R,css:ca.QW.chart,onUpdate:u,layout:k,config:Va,onHover:I,onUnhover:T})})})),qa=e=>{let{config:t,chartRunData:r,onDelete:a,onEdit:i}=e;const s=(0,n.useMemo)((()=>r.slice(0,t.runsCountToCompare||10).reverse()),[r,t]),{setTooltip:o,resetTooltip:l,selectedRunUuid:c}=fa(t);return(0,h.tZ)(xa,{onEdit:i,onDelete:a,title:`${t.xaxis.key} vs. ${t.yaxis.key} vs. ${t.zaxis.key}`,subtitle:(0,h.BX)(h.HY,{children:["Comparing first ",s.length," runs"]}),children:(0,h.tZ)("div",{css:Ga.contourChartCardWrapper,children:(0,h.tZ)(Ya,{runsData:s,xAxis:t.xaxis,yAxis:t.yaxis,zAxis:t.zaxis,useDefaultHoverBox:!1,onHover:o,onUnhover:l,selectedRunUuid:c})})})},Ga={contourChartCardWrapper:{overflow:"hidden"}},Qa={displaylogo:!1,doubleClick:"autosize",scrollZoom:!0},Ja=(e,t)=>{if(!e)return[];if("time-relative"===t){const{timestamp:t}=(0,c.minBy)(e,"timestamp")||{};if(t)return e.map((e=>(e.timestamp-t)/1e3))}else if("time"===t)return e.map((e=>e.timestamp));return e.map((e=>e.step))},ei=n.memo((e=>{let{runsData:t,metricKey:r,scaleType:a="linear",xAxisKey:i="step",className:o,margin:l=ca.MP,lineShape:c="spline",onUpdate:d,onHover:u,onUnhover:p,width:m,height:g,useDefaultHoverBox:v=!0,selectedRunUuid:f}=e;const y=(0,n.useMemo)((()=>t.map((e=>{var t,n;return e.metricsHistory?{uuid:e.runInfo.run_uuid,name:e.runInfo.run_name,x:Ja(e.metricsHistory[r],i),y:null===(t=e.metricsHistory[r])||void 0===t?void 0:t.map((e=>(0,ca.To)(e.value))),hovertext:e.runInfo.run_name,text:"x",textposition:"outside",textfont:{size:11},hovertemplate:v?(n=e.runInfo.run_name,`<b>${n}</b>:<br><b>%{xaxis.title.text}:</b> %{x}<br><b>%{yaxis.title.text}:</b> %{y:.2f}<br><extra></extra>`):void 0,hoverinfo:v?void 0:"none",hoverlabel:v?ca.Lg:void 0,type:"scatter",line:{shape:c},marker:{color:e.color}}:{}}))),[t,c,i,r,v]),{layoutHeight:C,layoutWidth:x,setContainerDiv:b,containerDiv:Z,isDynamicSizeSupported:E}=(0,ca.Ih)(),{formatMessage:R}=s(),{setHoveredPointIndex:S}=la(Z,f,t,sa),k=(0,n.useMemo)((()=>R("time"===i?{id:"y0rS56",defaultMessage:"Time"}:"time-relative"===i?{id:"d/lwTE",defaultMessage:"Time (s)"}:{id:"vPUy4a",defaultMessage:"Step"})),[R,i]),w=(0,n.useMemo)((()=>({tickfont:{size:11},type:"log"===a?"log":"linear"})),[a]),[M,B]=(0,n.useState)({width:m||x,height:g||C,margin:l,xaxis:{title:k},yaxis:w});(0,n.useEffect)((()=>{B((e=>({...e,width:m||x,height:g||C,margin:l,yaxis:w,showlegend:!1})))}),[x,C,l,w,m,g,k]);const T=(0,n.useCallback)((e=>{var t,r,n,a,i;let{points:s,event:o}=e;S(null!==(t=null===(r=s[0])||void 0===r?void 0:r.curveNumber)&&void 0!==t?t:-1);const l=(null===(n=s[0])||void 0===n?void 0:n.data).uuid,c={value:null===(a=s[0])||void 0===a?void 0:a.x,index:null===(i=s[0])||void 0===i?void 0:i.pointIndex,label:k};l&&(null===u||void 0===u||u(l,o,c))}),[u,S,k]),I=(0,n.useCallback)((()=>{null===p||void 0===p||p(),S(-1)}),[p,S]),L=M;L.xaxis&&(L.xaxis.title=k,L.xaxis.type="time"===i?"date":void 0),L.yaxis&&(L.yaxis.title=r);const A=na(T);return(0,h.tZ)("div",{css:[ca.QW.chartWrapper,ti.highlightStyles,""],className:o,ref:b,children:(0,h.tZ)(ra.L,{data:y,useResizeHandler:!E,css:ca.QW.chart,onUpdate:d,layout:L,config:Qa,onHover:A,onUnhover:I})})})),ti={highlightStyles:{".scatterlayer g.trace":{transition:"var(--trace-transition)"},".scatterlayer.is-highlight g.trace":{opacity:"var(--trace-opacity-dimmed-low) !important"},".scatterlayer g.trace.is-hover-highlight":{opacity:"var(--trace-opacity-highlighted) !important"},".scatterlayer g.trace.is-selection-highlight":{opacity:"var(--trace-opacity-highlighted) !important"},".scatterlayer g.trace.is-selection-highlight path.point":{stroke:"var(--trace-stroke-color)",strokeWidth:"var(--trace-stroke-width) !important"}}},ri=e=>{let{config:t,chartRunData:r,isMetricHistoryLoading:a,onDelete:i,onEdit:s}=e;const o=(0,n.useMemo)((()=>r.slice(0,t.runsCountToCompare||10).reverse()),[r,t]),{setTooltip:l,resetTooltip:c,selectedRunUuid:d}=fa(t);return(0,h.tZ)(xa,{onEdit:s,onDelete:i,title:t.metricKey,subtitle:(0,h.BX)(h.HY,{children:["Comparing first ",o.length," runs"]}),children:(0,h.tZ)("div",{css:ni.lineChartCardWrapper,children:a?(0,h.tZ)(v.OdW,{}):(0,h.tZ)(ei,{runsData:o,metricKey:t.metricKey,scaleType:t.scaleType,xAxisKey:t.xAxisKey,useDefaultHoverBox:!1,onHover:l,onUnhover:c,selectedRunUuid:d})})})},ni={lineChartCardWrapper:{overflow:"hidden"}},ai=e=>{let{chartRunData:t,cardsConfig:r,isMetricHistoryLoading:a,onRemoveChart:i,onStartEditChart:s}=e;const[o,l]=(0,n.useMemo)((()=>Array.isArray(r)?[r.filter((e=>e.type===dn.PARALLEL)),r.filter((e=>e.type!==dn.PARALLEL))]:[[],[]]),[r]);return(0,h.BX)(h.HY,{children:[o.length?(0,h.tZ)("div",{css:ii.parallelChartsWrapper,children:o.map((e=>(0,h.tZ)(Fa,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e)})))}):null,(0,h.tZ)("div",{css:ii.chartsWrapper,children:l.map((e=>e.type===dn.BAR?(0,h.tZ)(Ea,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e)}):e.type===dn.LINE?(0,h.tZ)(ri,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e),isMetricHistoryLoading:a}):e.type===dn.SCATTER?(0,h.tZ)($a,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e)}):e.type===dn.CONTOUR?(0,h.tZ)(qa,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e)}):null))})]})},ii={chartGroupWrapper:e=>({display:"flex",flexDirection:"column",gap:e.spacing.md}),parallelChartsWrapper:e=>({display:"flex",flexDirection:"column",gap:e.spacing.md,marginBottom:e.spacing.md}),chartsWrapper:e=>({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(520px, 1fr))",gap:e.spacing.md})},si=e=>{let{title:t,children:r}=e;return(0,h.BX)("div",{css:e=>({marginBottom:2*e.spacing.md}),"data-testid":"experiment-view-compare-runs-config-field",children:[(0,h.BX)(b.T.Title,{level:4,children:[t,":"]}),r]})},oi=e=>{let{value:t,onChange:r,metricKeyList:n,paramKeyList:a}=e;const{formatMessage:i}=s(),o=!(null!==a&&void 0!==a&&a.length)&&!(null!==n&&void 0!==n&&n.length);return(0,h.BX)(v.PhF,{css:di.selectFull,value:o?i({id:"3VURvw",defaultMessage:"No metrics or parameters available"}):t,disabled:o,onChange:r,dangerouslySetAntdProps:{showSearch:!0},children:[null!==n&&void 0!==n&&n.length?(0,h.tZ)(v.PhF.OptGroup,{label:i({id:"jH0+gA",defaultMessage:"Metrics"}),children:n.map((e=>(0,h.tZ)(v.PhF.Option,{value:Ke("METRIC",e),children:e},Ke("METRIC",e))))}):null,null!==a&&void 0!==a&&a.length?(0,h.tZ)(v.PhF.OptGroup,{label:i({id:"kWUhea",defaultMessage:"Params"}),children:a.map((e=>(0,h.tZ)(v.PhF.Option,{value:Ke("PARAM",e),children:e},Ke("PARAM",e))))}):null]})},li=e=>{let{onChange:t,value:r,options:n}=e;const{formatMessage:a}=s();return(0,h.tZ)(si,{title:a({id:"AW2rVK",defaultMessage:"Max. no of runs shown"}),children:(0,h.tZ)(v.PhF,{css:di.selectFull,value:r,onChange:t,children:n.map((e=>{const t="number"===typeof e?e:e.value,r="number"===typeof e?e:e.label;return(0,h.tZ)(v.PhF.Option,{value:t,children:r},t)}))})})},ci=[{value:5,label:(0,h.tZ)(E.Z,{id:"Mc6Dhy",defaultMessage:"5"})},{value:10,label:(0,h.tZ)(E.Z,{id:"2K8tsp",defaultMessage:"10"})},{value:20,label:(0,h.tZ)(E.Z,{id:"zwO8+l",defaultMessage:"20"})}],di={selectFull:{width:"100%"}},ui=e=>{let{state:t,onStateChange:r,metricKeyList:a}=e;const i=(0,n.useCallback)((e=>{r((t=>({...t,metricKey:e})))}),[r]),s=(0,n.useCallback)((e=>{r((t=>({...t,runsCountToCompare:e})))}),[r]);(0,n.useEffect)((()=>{!t.metricKey&&null!==a&&void 0!==a&&a[0]&&i(a[0])}),[t.metricKey,i,a]);const o=0===a.length;return(0,h.BX)(h.HY,{children:[(0,h.tZ)(si,{title:"Metric",children:(0,h.tZ)(v.PhF,{css:pi.selectFull,value:o?"No metrics available":t.metricKey,onChange:i,disabled:o,children:a.map((e=>(0,h.tZ)(v.PhF.Option,{value:e,"data-testid":`metric-${e}`,children:e},e)))})}),(0,h.tZ)(li,{value:t.runsCountToCompare,onChange:s,options:ci})]})},pi={selectFull:{width:"100%"}},hi=e=>{let{state:t,onStateChange:r,metricKeyList:a,paramKeyList:i}=e;const s=(0,n.useCallback)((e=>{r((t=>({...t,selectedParams:e})))}),[r]),o=(0,n.useCallback)((e=>{r((t=>({...t,selectedMetrics:e})))}),[r]),l=0===a.length,c=0===i.length;return(0,h.BX)(h.HY,{children:[(0,h.tZ)(si,{title:"Params",children:(0,h.tZ)(v.PhF,{mode:c?void 0:"multiple",onChange:s,style:{width:300},value:c?"No parameters available":t.selectedParams,disabled:c,children:i.map((e=>(0,h.tZ)(v.PhF.Option,{value:e,children:e})))})}),(0,h.tZ)(si,{title:"Metrics",children:(0,h.tZ)(v.PhF,{mode:l?void 0:"multiple",onChange:o,style:{width:300},value:l?"No metrics available":t.selectedMetrics,disabled:l,children:a.map((e=>(0,h.tZ)(v.PhF.Option,{value:e,children:e})))})})]})},mi=e=>{let{state:t,onStateChange:r,metricKeyList:a}=e;const i=(0,n.useCallback)((e=>{r((t=>({...t,metricKey:e})))}),[r]),s=(0,n.useCallback)((e=>{r((t=>({...t,xAxisKey:e})))}),[r]),o=(0,n.useCallback)((e=>r((t=>({...t,scaleType:e?"log":"linear"})))),[r]),l=(0,n.useCallback)((e=>{r((t=>({...t,runsCountToCompare:e})))}),[r]);(0,n.useEffect)((()=>{!t.metricKey&&null!==a&&void 0!==a&&a[0]&&i(a[0])}),[t.metricKey,i,a]);const c=0===a.length;return(0,h.BX)(h.HY,{children:[(0,h.tZ)(si,{title:"Metric (Y-axis)",children:(0,h.tZ)(v.PhF,{css:gi.selectFull,value:c?"No metrics available":t.metricKey,onChange:i,disabled:c,children:a.map((e=>(0,h.tZ)(v.PhF.Option,{value:e,"data-testid":`metric-${e}`,children:e},e)))})}),(0,h.tZ)(si,{title:"X-axis",children:(0,h.BX)(v.Y8K.Group,{value:t.xAxisKey,onChange:e=>{let{target:{value:t}}=e;return s(t)},children:[(0,h.tZ)(v.Y8K,{value:"step",children:"Step"}),(0,h.BX)(v.Y8K,{value:"time",children:["Time (wall)",(0,h.BX)(b.e,{title:(0,h.tZ)(E.Z,{id:"nlXn2G",defaultMessage:"Absolute date and time"}),placement:"right",children:[" ",(0,h.tZ)(v.AMp,{css:gi.timeStepQuestionMarkIcon})]})]}),(0,h.BX)(v.Y8K,{value:"time-relative",children:["Time (relative)",(0,h.BX)(b.e,{title:(0,h.tZ)(E.Z,{id:"NwNrl4",defaultMessage:"Amount of time that has passed since the first metric value was logged"}),placement:"right",children:[" ",(0,h.tZ)(v.AMp,{css:gi.timeStepQuestionMarkIcon})]})]})]})}),(0,h.tZ)(si,{title:"Y-axis log scale",children:(0,h.tZ)(v.rsf,{checked:"log"===t.scaleType,onChange:o,label:"Enabled"})}),(0,h.tZ)(li,{value:t.runsCountToCompare,onChange:l,options:[5,10,20]})]})},gi={selectFull:{width:"100%"},timeStepQuestionMarkIcon:()=>({svg:{width:12,height:12}})},vi=(e,t,r)=>{const a=p(),[i,s]=(0,n.useState)(null),[l,c]=(0,n.useState)({}),d=(0,n.useCallback)(((e,t,r)=>{c((n=>{const a={...n};for(const i of e){a[`${i}-${t}`]=r}return a}))}),[c]),u=(0,n.useCallback)(((e,t)=>d(e,t,!0)),[d]),h=(0,n.useCallback)(((e,t)=>d(e,t,!1)),[d]),m=(0,n.useMemo)((()=>{const r=t.map((e=>e.runInfo.run_uuid));for(const t of r)for(const r of e){if(l[`${t}-${r}`])return!0}return!1}),[e,l,t]);return(0,n.useEffect)((()=>{if(e.length)for(const n of e){if(!n)continue;const e=t.map((e=>e.runInfo.run_uuid)).filter((e=>{var t;const a=Boolean(null===(t=r[e])||void 0===t?void 0:t[n]),i=l[`${e}-${n}`];return!a&&!i}));e.length&&(u(e,n),a((0,o.zL)(e,n)).then((()=>{h(e,n)})).catch((e=>{s(e)})))}}),[u,r,a,h,e,l,t]),{isLoading:m,error:i}},fi=(0,u.$j)((e=>{let{entities:{metricsByRunUuid:t}}=e;return{metricsByRunUuid:t}}),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.metricsByRunUuid===t.entities.metricsByRunUuid})((e=>{let{previewData:t,cardConfig:r,metricsByRunUuid:a}=e;const i=(0,n.useMemo)((()=>[r.metricKey]),[r.metricKey]),{isLoading:s,error:o}=vi(i,t,a),l=(0,n.useMemo)((()=>t.map((e=>({...e,metricsHistory:a[e.runInfo.run_uuid]})))),[t,a]),{resetTooltip:c,setTooltip:d}=fa(r);return s?(0,h.tZ)(v.OdW,{}):o?(0,h.tZ)(h.HY,{children:"Error occured!"}):(0,h.tZ)(ei,{runsData:l,metricKey:r.metricKey,scaleType:r.scaleType,xAxisKey:r.xAxisKey,useDefaultHoverBox:!1,onHover:d,onUnhover:c})}));var yi={name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"};const Ci=e=>{let{state:t,onStateChange:r,metricKeyList:a,paramKeyList:i}=e;const{formatMessage:o}=s(),l=(0,n.useCallback)(((e,t)=>{const n=Xe(e,"METRIC")?"METRIC":"PARAM",a=We(e,n);r((e=>({...e,[t]:{key:a,type:n}})))}),[r]),c=(0,n.useCallback)((e=>{r((t=>({...t,runsCountToCompare:e})))}),[r]);return(0,n.useEffect)((()=>{var e,r,n;const s=null===a||void 0===a?void 0:a[0],o=null===i||void 0===i?void 0:i[0];null!==(e=t.xaxis)&&void 0!==e&&e.key||(s?l(Ke("METRIC",s),"xaxis"):o&&l(Ke("PARAM",o),"xaxis")),null!==(r=t.yaxis)&&void 0!==r&&r.key||(s?l(Ke("METRIC",s),"yaxis"):o&&l(Ke("PARAM",o),"yaxis")),null!==(n=t.zaxis)&&void 0!==n&&n.key||(s?l(Ke("METRIC",s),"zaxis"):o&&l(Ke("PARAM",o),"zaxis"))}),[t.xaxis,t.yaxis,t.zaxis,l,a,i]),(0,h.BX)(h.HY,{children:[(0,h.tZ)(si,{title:o({id:"2Us2jl",defaultMessage:"X axis"}),children:(0,h.tZ)(oi,{value:t.xaxis.key?Ke(t.xaxis.type,t.xaxis.key):"",onChange:e=>{l(e,"xaxis")},paramKeyList:i,metricKeyList:a})}),(0,h.tZ)(si,{title:o({id:"8YmId5",defaultMessage:"Y axis"}),children:(0,h.tZ)(oi,{value:t.yaxis.key?Ke(t.yaxis.type,t.yaxis.key):"",onChange:e=>{l(e,"yaxis")},paramKeyList:i,metricKeyList:a})}),(0,h.tZ)(si,{title:o({id:"cB0/61",defaultMessage:"Z axis"}),children:(0,h.tZ)(oi,{value:t.zaxis.key?Ke(t.zaxis.type,t.zaxis.key):"",onChange:e=>{l(e,"zaxis")},paramKeyList:i,metricKeyList:a})}),(0,h.tZ)(li,{value:t.runsCountToCompare,onChange:c,options:[5,10,20]})]})},xi=ci;xi.push({value:100,label:(0,h.tZ)(E.Z,{id:"Bbm59f",defaultMessage:"100"})},{value:250,label:(0,h.tZ)(E.Z,{id:"W8bOkn",defaultMessage:"250"})},{value:500,label:(0,h.tZ)(E.Z,{id:"Bnruyp",defaultMessage:"500"})});const bi=e=>{let{state:t,onStateChange:r,metricKeyList:a,paramKeyList:i}=e;const{formatMessage:o}=s(),l=(0,n.useCallback)(((e,t)=>{const n=Xe(e,"METRIC")?"METRIC":"PARAM",a=We(e,n);r((e=>({...e,[t]:{key:a,type:n}})))}),[r]),c=(0,n.useCallback)((e=>{r((t=>({...t,runsCountToCompare:e})))}),[r]);return(0,n.useEffect)((()=>{var e,r;const n=null===a||void 0===a?void 0:a[0],s=null===i||void 0===i?void 0:i[0];null!==(e=t.xaxis)&&void 0!==e&&e.key||(n?l(Ke("METRIC",n),"xaxis"):s&&l(Ke("PARAM",s),"xaxis")),null!==(r=t.yaxis)&&void 0!==r&&r.key||(n?l(Ke("METRIC",n),"yaxis"):s&&l(Ke("PARAM",s),"yaxis"))}),[t.xaxis,t.yaxis,l,a,i]),(0,h.BX)(h.HY,{children:[(0,h.tZ)(si,{title:o({id:"vBKFgp",defaultMessage:"X axis"}),children:(0,h.tZ)(oi,{value:t.xaxis.key?Ke(t.xaxis.type,t.xaxis.key):"",onChange:e=>{l(e,"xaxis")},paramKeyList:i,metricKeyList:a})}),(0,h.tZ)(si,{title:o({id:"DaF+KK",defaultMessage:"Y axis"}),children:(0,h.tZ)(oi,{value:t.yaxis.key?Ke(t.yaxis.type,t.yaxis.key):"",onChange:e=>{l(e,"yaxis")},paramKeyList:i,metricKeyList:a})}),(0,h.tZ)(li,{value:t.runsCountToCompare,onChange:c,options:xi})]})},Zi=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;if("number"===typeof e)return e.toFixed(t);const r=Number(e);return isNaN(r)?(0,ca.aS)(e,8):r.toFixed(t)},Ei=e=>{let{activeRun:t,cardConfig:r,isHovering:n,xAxisValues:a}=e;return r.type===dn.BAR?((e,t)=>{const{metricKey:r}=e,n=null===t||void 0===t?void 0:t.metrics[r];return n?(0,h.BX)("div",{css:Si.value,children:[(0,h.BX)("strong",{children:[n.key,":"]})," ",Zi(n.value)]}):null})(r,t):r.type===dn.SCATTER?((e,t)=>{var r,n,a,i;const{xaxis:s,yaxis:o}=e,l=s.key,c=o.key,d="METRIC"===s.type?null===(r=t.metrics[l])||void 0===r?void 0:r.value:null===(n=t.params[l])||void 0===n?void 0:n.value,u="METRIC"===o.type?null===(a=t.metrics[c])||void 0===a?void 0:a.value:null===(i=t.params[c])||void 0===i?void 0:i.value;return(0,h.BX)(h.HY,{children:[d&&(0,h.BX)("div",{css:Si.value,children:[(0,h.BX)("strong",{children:["X (",l,"):"]})," ",Zi(d)]}),u&&(0,h.BX)("div",{css:Si.value,children:[(0,h.BX)("strong",{children:["Y (",c,"):"]})," ",Zi(u)]})]})})(r,t):r.type===dn.CONTOUR?((e,t)=>{var r,n,a,i,s,o;const{xaxis:l,yaxis:c,zaxis:d}=e,u=l.key,p=c.key,m=d.key,g="METRIC"===l.type?null===(r=t.metrics[u])||void 0===r?void 0:r.value:null===(n=t.params[u])||void 0===n?void 0:n.value,v="METRIC"===c.type?null===(a=t.metrics[p])||void 0===a?void 0:a.value:null===(i=t.params[p])||void 0===i?void 0:i.value,f="METRIC"===d.type?null===(s=t.metrics[m])||void 0===s?void 0:s.value:null===(o=t.params[m])||void 0===o?void 0:o.value;return(0,h.BX)(h.HY,{children:[g&&(0,h.BX)("div",{css:Si.value,children:[(0,h.BX)("strong",{children:["X (",u,"):"]})," ",Zi(g)]}),v&&(0,h.BX)("div",{css:Si.value,children:[(0,h.BX)("strong",{children:["Y (",p,"):"]})," ",Zi(v)]}),f&&(0,h.BX)("div",{css:Si.value,children:[(0,h.BX)("strong",{children:["Z (",m,"):"]})," ",Zi(f)]})]})})(r,t):r.type===dn.LINE?((e,t,r)=>{var n,a,i;const{metricKey:s}=e,o=null!==(n=r&&(null===t||void 0===t||null===(a=t.metricsHistory)||void 0===a||null===(i=a[s])||void 0===i?void 0:i[null===r||void 0===r?void 0:r.index]))&&void 0!==n?n:null===t||void 0===t?void 0:t.metrics[s];return o?(0,h.BX)(h.HY,{children:[r&&(0,h.BX)("div",{css:Si.value,children:[(0,h.BX)("strong",{children:[r.label,":"]})," ",r.value]}),(0,h.BX)("div",{css:Si.value,children:[(0,h.BX)("strong",{children:[o.key,":"]})," ",Zi(o.value)]})]}):null})(r,t,a):r.type===dn.PARALLEL?((e,t,r)=>{const{selectedParams:n,selectedMetrics:a}=e,i=n.map((e=>{const r=null===t||void 0===t?void 0:t.params[e];return!r||(0,h.BX)("div",{children:[(0,h.BX)("strong",{children:[r.key,":"]})," ",Zi(r.value)]})})),s=a.map((e=>{const r=null===t||void 0===t?void 0:t.metrics[e];return!r||(0,h.BX)("div",{children:[(0,h.BX)("strong",{children:[r.key,":"]})," ",Zi(r.value)]})}));return r?(0,h.BX)(h.HY,{children:[i.slice(0,3),s[s.length-1],(i.length>3||s.length>1)&&(0,h.tZ)("div",{children:"..."})]}):(0,h.BX)(h.HY,{children:[i,s]})})(r,t,n):null},Ri=e=>{let{closeContextMenu:t,contextData:r,additionalAxisData:n,hoverData:a,runUuid:i,isHovering:s}=e;const{runs:o,onTogglePin:l,onHideRun:c}=r,[d]=pt(),u=null===o||void 0===o?void 0:o.find((e=>e.runInfo.run_uuid===i));return u?(0,h.BX)("div",{children:[(0,h.BX)("div",{css:Si.contentWrapper,children:[(0,h.BX)("div",{css:Si.header,children:[(0,h.tZ)("div",{css:Si.colorPill,style:{backgroundColor:u.color}}),(0,h.tZ)(ie.rU,{to:se.Z.getRunPageRoute(d,i),target:"_blank",css:Si.runLink,onClick:t,children:u.runInfo.run_name||u.runInfo.run_uuid})]}),!s&&(0,h.tZ)(b.B,{size:"small",onClick:t,icon:(0,h.tZ)(b.b,{})})]}),(0,h.tZ)(Ei,{isHovering:s,activeRun:u,cardConfig:a,xAxisValues:n}),(0,h.BX)("div",{css:Si.actionsWrapper,children:[u.pinnable&&l&&(0,h.tZ)(b.e,{title:u.pinned?(0,h.tZ)(E.Z,{id:"ugm2f6",defaultMessage:"Unpin run"}):(0,h.tZ)(E.Z,{id:"58xhem",defaultMessage:"Click to pin the run"}),placement:"bottom",children:(0,h.tZ)(b.B,{size:"small",onClick:()=>{l(i),t()},icon:u.pinned?(0,h.tZ)(v.D$V,{}):(0,h.tZ)(v.qQX,{})})}),c&&(0,h.tZ)(b.e,{title:(0,h.tZ)(E.Z,{id:"eE5VIF",defaultMessage:"Click to hide the run"}),placement:"bottom",children:(0,h.tZ)(b.B,{"data-testid":"experiment-view-compare-runs-tooltip-visibility-button",size:"small",onClick:()=>{c(i),t()},icon:(0,h.tZ)(v.bMb,{})})})]})]}):null},Si={runLink:e=>({color:e.colors.primary,"&:hover":{}}),actionsWrapper:{marginTop:8,display:"flex",gap:8,alignItems:"center"},header:{display:"flex",gap:8,alignItems:"center"},value:{maxWidth:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},contentWrapper:{display:"flex",gap:8,alignItems:"center",marginBottom:12,justifyContent:"space-between",height:24},colorPill:{width:12,height:12,borderRadius:"100%"}};const ki={[dn.BAR]:e=>{let{previewData:t,cardConfig:r}=e;const{resetTooltip:n,setTooltip:a}=fa(r);return(0,h.tZ)(ua,{useDefaultHoverBox:!1,displayRunNames:!1,displayMetricKey:!1,metricKey:r.metricKey,runsData:t,margin:Za,onHover:a,onUnhover:n})},[dn.CONTOUR]:e=>{let{previewData:t,cardConfig:r}=e;const{resetTooltip:n,setTooltip:a}=fa(r);return(0,h.tZ)(Ya,{xAxis:r.xaxis,yAxis:r.yaxis,zAxis:r.zaxis,runsData:t,onHover:a,onUnhover:n,useDefaultHoverBox:!1})},[dn.LINE]:fi,[dn.PARALLEL]:e=>{var t,r;let{previewData:n,cardConfig:a}=e;const i=((null===(t=a.selectedParams)||void 0===t?void 0:t.length)||0)+((null===(r=a.selectedMetrics)||void 0===r?void 0:r.length)||0)>=2,{setTooltip:s,resetTooltip:o}=fa(a),l=i?Aa(n,a.selectedParams,a.selectedMetrics):[];return i?l.length?(0,h.tZ)(Da,{selectedMetrics:a.selectedMetrics,selectedParams:a.selectedParams,data:l,axesRotateThreshold:6,onHover:s,onUnhover:o}):null:(0,h.tZ)("div",{css:yi,children:"Select at least two metrics and params first"})},[dn.SCATTER]:e=>{let{previewData:t,cardConfig:r}=e;const{resetTooltip:n,setTooltip:a}=fa(r);return(0,h.tZ)(Wa,{xAxis:r.xaxis,yAxis:r.yaxis,runsData:t,onHover:a,onUnhover:n,useDefaultHoverBox:!1})}};var wi={name:"1uahl7",styles:"width:1280px"},Mi={name:"1d3w5wq",styles:"width:100%"};const Bi=e=>{let{onCancel:t,onSubmit:r,config:a,chartRunData:i,metricKeyList:o,paramKeyList:l}=e;const[c,d]=(0,n.useState)(a),u=Boolean(c.uuid),p=(0,n.useCallback)((e=>{if(!e)return;const t=un.getEmptyChartCardByType(e);t&&d(t)}),[]),m=(0,n.useMemo)((()=>i.slice(0,c.runsCountToCompare).reverse()),[i,c.runsCountToCompare]),{formatMessage:g}=s();return(0,h.tZ)(v.u_l,{visible:!0,onCancel:t,onOk:()=>r(c),title:g(u?{id:"kBXHTA",defaultMessage:"Edit chart"}:{id:"6y36Fr",defaultMessage:"Add new chart"}),okButtonProps:{"data-testid":"experiment-view-compare-runs-chart-modal-confirm"},cancelText:g({id:"TlVXcS",defaultMessage:"Cancel"}),okText:g(u?{id:"vPnoNk",defaultMessage:"Save changes"}:{id:"UzZf+2",defaultMessage:"Add chart"}),size:"wide",css:wi,children:(0,h.BX)("div",{css:Ti.wrapper,children:[(0,h.BX)("div",{children:[!u&&(0,h.tZ)(si,{title:"Type",children:(0,h.BX)(v.PhF,{css:Mi,value:c.type,onChange:p,children:[(0,h.tZ)(v.PhF.Option,{value:dn.BAR,children:(0,h.BX)("div",{css:Ti.chartTypeOption,children:[(0,h.tZ)(Rn,{}),"Bar chart"]})}),(0,h.tZ)(v.PhF.Option,{value:dn.SCATTER,children:(0,h.BX)("div",{css:Ti.chartTypeOption,children:[(0,h.tZ)(Jn,{}),"Scatter chart"]})}),(0,h.tZ)(v.PhF.Option,{value:dn.LINE,children:(0,h.BX)("div",{css:Ti.chartTypeOption,children:[(0,h.tZ)(Nn,{}),"Line chart"]})}),(0,h.tZ)(v.PhF.Option,{value:dn.PARALLEL,children:(0,h.BX)("div",{css:Ti.chartTypeOption,children:[(0,h.tZ)(Xn,{}),"Parallel coordinates"]})}),(0,h.tZ)(v.PhF.Option,{value:dn.CONTOUR,children:(0,h.BX)("div",{css:Ti.chartTypeOption,children:[(0,h.tZ)(Tn,{}),"Contour chart"]})})]})}),(f=c.type,f===dn.BAR?(0,h.tZ)(ui,{metricKeyList:o,state:c,onStateChange:d}):f===dn.CONTOUR?(0,h.tZ)(Ci,{metricKeyList:o,paramKeyList:l,state:c,onStateChange:d}):f===dn.LINE?(0,h.tZ)(mi,{metricKeyList:o,state:c,onStateChange:d}):f===dn.PARALLEL?(0,h.tZ)(hi,{metricKeyList:o,paramKeyList:l,state:c,onStateChange:d}):f===dn.SCATTER?(0,h.tZ)(bi,{metricKeyList:o,paramKeyList:l,state:c,onStateChange:d}):null)]}),(0,h.tZ)(va,{contextData:{runs:i},component:Ri,hoverOnly:!0,children:(0,h.tZ)("div",{css:Ti.chartWrapper,children:(e=>{if(!e)return null;const t=ki[e];return t?(0,h.tZ)(t,{previewData:m,cardConfig:c}):null})(c.type)})})]})});var f},Ti={chartTypeOption:e=>({display:"grid",gridTemplateColumns:`${e.general.iconSize+e.spacing.xs}px 1fr`,gap:e.spacing.xs,alignItems:"center"}),wrapper:{display:"grid",gridTemplateColumns:"300px 1fr",gap:32},field:{display:"grid",gridTemplateColumns:"80px 1fr",marginBottom:16},chartWrapper:{height:400}},Ii={controlsWrapper:e=>({marginBottom:e.spacing.md,display:"flex",justifyContent:"flex-end"}),wrapper:e=>({marginLeft:-1,position:"relative",backgroundColor:e.colors.backgroundSecondary,padding:e.spacing.md,borderLeft:`1px solid ${e.colors.border}`,zIndex:1,overflowY:"auto"})},Li=(0,u.$j)((e=>{let{entities:t}=e;const{paramsByRunUuid:r,latestMetricsByRunUuid:n,metricsByRunUuid:a}=t;return{paramsByRunUuid:r,latestMetricsByRunUuid:n,metricsByRunUuid:a}}),void 0,void 0,{areStatesEqual:(e,t)=>e.entities===t.entities})((e=>{let{comparedRuns:t,isLoading:r,searchFacetsState:a,updateSearchFacets:i,latestMetricsByRunUuid:s,metricsByRunUuid:o,paramsByRunUuid:l,metricKeyList:d,paramKeyList:u,experimentTags:p}=e;const[m,g]=(0,n.useState)(!1),[f,y]=(0,n.useState)(null),C=(0,n.useCallback)((e=>{y(un.getEmptyChartCardByType(e))}),[]),x=(0,n.useCallback)((e=>{y(e)}),[]);(0,n.useEffect)((()=>{m||r||g(!0)}),[m,r]);const b=(0,n.useMemo)((()=>{const e=p[G.uN],t=p[G.JG];return(null===e||void 0===e?void 0:e.value)||(null===t||void 0===t?void 0:t.value)||d[0]||""}),[p,d]);(0,n.useEffect)((()=>{a.compareRunCharts||i((e=>({...e,compareRunCharts:un.getBaseChartConfigs(b)})),{replaceHistory:!0})}),[a.compareRunCharts,b,i]);const Z=(0,n.useCallback)((e=>{i((t=>({...t,runsPinned:t.runsPinned.includes(e)?t.runsPinned.filter((t=>t!==e)):[...t.runsPinned,e]})))}),[i]),E=(0,n.useCallback)((e=>{i((t=>({...t,runsHidden:[...t.runsHidden,e]})))}),[i]),R=(0,n.useMemo)((()=>t.filter((e=>!e.hidden)).map((e=>({runInfo:e.runInfo,metrics:s[e.runUuid]||{},params:l[e.runUuid]||{},color:e.color,pinned:e.pinned,pinnable:e.pinnable,metricsHistory:{}})))),[t,s,l]),{isLoading:S,chartRunDataWithHistory:k}=((e,t,r)=>{const a=(0,n.useMemo)((()=>e.filter((e=>e.type===dn.LINE))),[e]),i=(0,n.useMemo)((()=>{if(!a.length)return[];const e=(0,c.max)(a.map((e=>e.runsCountToCompare||10)));return t.slice(0,e)}),[a,t]),s=(0,n.useMemo)((()=>Array.from(new Set(a.map((e=>e.metricKey))))),[a]),{isLoading:o}=vi(s,i,r);return{isLoading:o,chartRunDataWithHistory:(0,n.useMemo)((()=>i.length?t.map((e=>({...e,metricsHistory:r[e.runInfo.run_uuid]||void 0}))):t),[i,r,t])}})(a.compareRunCharts||[],R,o),w=(0,n.useMemo)((()=>({runs:k,onTogglePin:Z,onHideRun:E})),[k,E,Z]);return m?(0,h.BX)("div",{css:Ii.wrapper,"data-testid":"experiment-view-compare-runs-chart-area",children:[(0,h.tZ)("div",{css:Ii.controlsWrapper,children:(0,h.tZ)(ea,{onAddChart:C})}),(0,h.tZ)(va,{contextData:w,component:Ri,children:(0,h.tZ)(ai,{chartRunData:k,cardsConfig:a.compareRunCharts||[],onStartEditChart:x,onRemoveChart:e=>{i((t=>{var r;return{...t,compareRunCharts:null===(r=t.compareRunCharts)||void 0===r?void 0:r.filter((t=>t.uuid!==e.uuid))}}))},isMetricHistoryLoading:S})}),f&&(0,h.tZ)(Bi,{chartRunData:k,metricKeyList:d,paramKeyList:u,config:f,onSubmit:e=>{const t=un.serialize({...e,uuid:(0,cn.Fs)()});e.uuid?i((r=>{var n;return{...r,compareRunCharts:null===(n=r.compareRunCharts)||void 0===n?void 0:n.map((r=>r.uuid===e.uuid?t:r))}})):i((e=>({...e,compareRunCharts:e.compareRunCharts&&[...e.compareRunCharts,t]}))),y(null)},onCancel:()=>y(null)})]}):(0,h.tZ)("div",{css:Ii.wrapper,children:(0,h.tZ)(v.OdW,{})})})),Ai=()=>{const e=new Date;return e.setMilliseconds(0),e},Di=n.memo((e=>{const{experiments:t,runsData:r}=e,{searchFacetsState:a,updateSearchFacets:i,fetchExperimentRuns:s,isLoadingRuns:o,loadMoreRuns:c,moreRunsAvailable:d,requestError:u}=Dt(),[p,m]=(0,n.useState)([]),[g,v]=(0,n.useState)(new nn);(0,n.useEffect)((()=>{s()}),[]);const{paramKeyList:f,metricKeyList:y,tagsList:C,modelVersionsByRunUuid:x,paramsList:b,metricsList:Z,runInfos:E,runUuidsMatchingFilter:R}=r,S=(0,n.useCallback)((e=>v((t=>({...t,...e})))),[]),k=(0,n.useCallback)((()=>{S({columnSelectorVisible:!0})}),[S]),{orderByKey:w,searchFilter:M,runsExpanded:B,runsPinned:T,isComparingRuns:I,runsHidden:L}=a,A=(0,n.useMemo)((()=>!w&&!M||w===G.XZ.DATE),[w,M]),[D,N]=(0,n.useState)(Ai);(0,n.useEffect)((()=>{N(Ai)}),[E]);const O=(0,n.useMemo)((()=>l.Z.getVisibleTagKeyList(C)),[C]);(0,n.useEffect)((()=>{if(o)return;const e=ln({experiments:t,paramKeyList:f,metricKeyList:y,modelVersionsByRunUuid:x,runsExpanded:B,tagKeyList:O,nestChildren:A,referenceTime:D,runData:E.map(((e,t)=>({runInfo:e,params:b[t],metrics:Z[t],tags:C[t]}))),runUuidsMatchingFilter:R,runsPinned:T,runsHidden:L});m(e)}),[o,t,y,Z,x,f,b,E,B,C,O,A,D,T,L,R,u]);const P=(0,n.useCallback)((()=>{d&&!o&&c()}),[d,o,c]);return(0,h.BX)(h.HY,{children:[(0,h.tZ)(Nr,{viewState:g,updateViewState:S,runsData:r,searchFacetsState:a,updateSearchFacets:i,requestError:u}),(0,h.BX)("div",{css:Ni.createRunsTableWrapper(I),children:[(0,h.tZ)(en,{experiments:t,runsData:r,searchFacetsState:a,viewState:g,isLoading:o,updateSearchFacets:i,updateViewState:S,onAddColumnClicked:k,rowsData:p,loadMoreRunsFunc:P,moreRunsAvailable:d}),I&&(0,h.tZ)(Li,{isLoading:o,comparedRuns:p,metricKeyList:r.metricKeyList,paramKeyList:r.paramKeyList,experimentTags:r.experimentTags,searchFacetsState:a,updateSearchFacets:i})]})]})})),Ni={createRunsTableWrapper:e=>({minHeight:225,height:"100%",display:"grid",position:"relative",gridTemplateColumns:e?"310px 1fr":"1fr"}),loadingFooter:()=>({justifyContent:"center",alignItems:"center",display:"flex",height:"72px"})},Oi={searchRunsApi:o.ht,loadMoreRunsApi:o.mx,searchRunsPayload:o.Yl,searchModelVersionsApi:rn.nI},Pi=(0,u.$j)(((e,t)=>({runsData:q(e,t)})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.experimentTagsByExperimentId===t.entities.experimentTagsByExperimentId&&e.entities.latestMetricsByRunUuid===t.entities.latestMetricsByRunUuid&&e.entities.modelVersionsByRunUuid===t.entities.modelVersionsByRunUuid&&e.entities.paramsByRunUuid===t.entities.paramsByRunUuid&&e.entities.runInfosByUuid===t.entities.runInfosByUuid&&e.entities.runUuidsMatchingFilter===t.entities.runUuidsMatchingFilter&&e.entities.tagsByRunUuid===t.entities.tagsByRunUuid})(Di),Ui=e=>{const{searchFacetsState:t}=Dt();return(0,h.tZ)(Pi,{...e,modelVersionFilter:t.modelVersionFilter,lifecycleFilter:t.lifecycleFilter})},Hi=e=>(0,h.tZ)(At,{actions:Oi,children:(0,h.tZ)(Ui,{...e})}),Fi=()=>{const e=pt(),t=(r=e,(0,u.v9)((e=>r.map((t=>e.entities.experimentsById[t])).filter(Boolean)),((e,t)=>(0,c.isEqual)(e,t))));var r;const[a]=t,{fetchExperiments:i,isLoadingExperiment:s,requestError:o}=I();(0,n.useEffect)((()=>{i(e)}),[i,e]);const l=e.length>1;return o&&o.getErrorCode()===f.SM.PERMISSION_DENIED?(0,h.tZ)(Z,{errorMessage:o.getMessageField()}):o&&o.getErrorCode()===f.SM.RESOURCE_DOES_NOT_EXIST?(0,h.tZ)(y.Z,{}):s||!a?(0,h.tZ)(v.OdW,{active:!0}):(0,h.BX)("div",{css:_i.experimentViewWrapper,children:[l?(0,h.tZ)(z,{experiments:t}):(0,h.BX)(h.HY,{children:[(0,h.tZ)(W,{experiment:a}),(0,h.tZ)(S,{experiment:a}),(0,h.tZ)(L,{experiment:a})]}),(0,h.tZ)(Hi,{experiments:t})]})},_i={experimentViewWrapper:{height:"100%",display:"flex",flexDirection:"column"}};const Ki={setExperimentTagApi:o.Yp,getExperimentApi:o.eu,setCompareExperiments:o.MY},Xi=()=>{const{formatMessage:e}=s();return(0,n.useEffect)((()=>{const t=e({id:"5GCYzy",defaultMessage:"Experiment Runs - Databricks"});l.Z.updatePageTitle(t)})),(0,h.tZ)(g,{actions:Ki,children:(0,h.tZ)(Fi,{})})};var Wi=Xi},43339:function(e,t,r){r.d(t,{Ih:function(){return i},Lg:function(){return c},MP:function(){return o},QW:function(){return s},To:function(){return d},aS:function(){return u},r$:function(){return l}});var n=r(32048),a=r(4519);const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;const[t,r]=(0,a.useState)(void 0),[i,s]=(0,a.useState)(void 0),o=Boolean(window.ResizeObserver),l=(0,a.useCallback)(((e,t)=>{r(e),s(t)}),[]),c=(0,a.useMemo)((()=>(0,n.throttle)(l,e,{leading:!0})),[l,e]),[d,u]=(0,a.useState)(null);return(0,a.useEffect)((()=>{let e=!1;if(!d||!window.ResizeObserver)return;const t=new ResizeObserver((t=>{let[r]=t;e||c(Math.round(r.contentRect.width),Math.round(r.contentRect.height))}));return t.observe(d),()=>{e=!0,t.disconnect()}}),[d,c]),{containerDiv:d,setContainerDiv:u,layoutWidth:t,layoutHeight:i,isDynamicSizeSupported:o}},s={scatterChartHighlightStyles:{".trace.scatter path.point":{transition:"var(--trace-transition)"},".trace.scatter.is-highlight path.point":{opacity:"var(--trace-opacity-dimmed-low) !important"},".trace.scatter path.point.is-hover-highlight":{opacity:"var(--trace-opacity-highlighted) !important"},".trace.scatter path.point.is-selection-highlight":{opacity:"var(--trace-opacity-highlighted) !important",stroke:"var(--trace-stroke-color)",strokeWidth:"var(--trace-stroke-width) !important"}},chartWrapper:()=>({width:"100%",height:"100%",overflow:"hidden",position:"relative",fontSize:0,lineHeight:0,".js-plotly-plot .plotly .cursor-ew-resize, .js-plotly-plot .plotly .cursor-crosshair":{cursor:"pointer"},".js-plotly-plot g.infolayer > g.g-ytitle > text":{stroke:"white",strokeWidth:16,paintOrder:"stroke"},"--trace-transition":"opacity .16s","--trace-opacity-highlighted":"1","--trace-opacity-dimmed-low":"0.45","--trace-opacity-dimmed-high":"0.55","--trace-stroke-color":"black","--trace-stroke-width":"1"}),chart:{width:"100%",height:"100%"}},o={t:0,b:48,r:0,l:48,pad:0},l={t:0,b:48,r:0,l:80,pad:0},c={bgcolor:"white",bordercolor:"#ccc",font:{color:"black"}},d=e=>{const t="string"===typeof e?parseFloat(e):e;return t?Number.isFinite(t)&&!Number.isNaN(t)?Math.abs(t)===Number.MAX_VALUE?Number.POSITIVE_INFINITY*Math.sign(t):e:void 0:t},u=(e,t)=>{if(e.length<=t)return e;const r=t-"...".length,n=Math.ceil(r/2),a=Math.floor(r/2);return e.substr(0,n)+"..."+e.substr(e.length-a)}}}]);
//# sourceMappingURL=964.356f122f.chunk.js.map